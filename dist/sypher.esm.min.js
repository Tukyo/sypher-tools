import{ethers as e}from"ethers";const t=/^0x[a-fA-F0-9]{40}$/,n={ethereum:{params:[{chainId:"0x1"}],priceFeeds:{eth:"0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419"},pairAddresses:{eth:"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"}},arbitrum:{params:[{chainId:"0xa4b1"}],priceFeeds:{eth:"0x639Fe6ab55C921f74e7fac1ee960C0B6293ba612",arb:"0xb2A824043730FE05F3DA2efaFa1CBbe83fa548D6"},pairAddresses:{eth:"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",arb:"0xB50721BCf8d664c30412Cfbc6cf7a15145234ad1"}},optimism:{params:[{chainId:"0xa"}],priceFeeds:{eth:"0xb7B9A39CC63f856b90B364911CC324dC46aC1770",op:"0x0D276FC14719f9292D5C1eA2198673d1f4269246"},pairAddresses:{eth:"0x4200000000000000000000000000000000000006",op:"0x4200000000000000000000000000000000000042"}},base:{params:[{chainId:"0x2105"}],priceFeeds:{eth:"0x71041dddad3595F9CEd3DcCFBe3D1F4b0a16Bb70"},pairAddresses:{eth:"0x4200000000000000000000000000000000000006"}},polygon:{params:[{chainId:"0x89"}],priceFeeds:{eth:"0xF9680D99D6C9589e2a93a78A04A279e509205945",matic:"0xAB594600376Ec9fD91F8e885dADF0CE036862dE0"},pairAddresses:{eth:"0x11CD37bb86F65419713f30673A480EA33c826872",matic:"0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"}},avalanche:{params:[{chainId:"0xa86a"}],priceFeeds:{eth:"0x976B3D034E162d8bD72D6b9C989d545b839003b0",avax:"0x0A77230d17318075983913bC2145DB16C7366156"},pairAddresses:{eth:"",avax:""}},fantom:{params:[{chainId:"0xfa"}],priceFeeds:{eth:"0x11DdD3d147E5b83D01cee7070027092397d63658",ftm:"0xf4766552D15AE4d256Ad41B6cf2933482B0680dc"},pairAddresses:{eth:"",ftm:""}}},i=[],r=[{info:{icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTI4IDU2YzE1LjQ2NCAwIDI4LTEyLjUzNiAyOC0yOFM0My40NjQgMCAyOCAwIDAgMTIuNTM2IDAgMjhzMTIuNTM2IDI4IDI4IDI4WiIgZmlsbD0iIzFCNTNFNCIvPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNyAyOGMwIDExLjU5OCA5LjQwMiAyMSAyMSAyMXMyMS05LjQwMiAyMS0yMVMzOS41OTggNyAyOCA3IDcgMTYuNDAyIDcgMjhabTE3LjIzNC02Ljc2NmEzIDMgMCAwIDAtMyAzdjcuNTMzYTMgMyAwIDAgMCAzIDNoNy41MzNhMyAzIDAgMCAwIDMtM3YtNy41MzNhMyAzIDAgMCAwLTMtM2gtNy41MzNaIiBmaWxsPSIjZmZmIi8+PC9zdmc+",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",uuid:"96b79a0d-c5cd-48de-924b-af5c7bb68b7e",onboard:{bool:!0,link:"https://www.coinbase.com/wallet",deeplink:"cbwallet://",fallback:{ios:"https://apps.apple.com/us/app/coinbase-wallet-nfts-crypto/id1278383455",android:"https://play.google.com/store/apps/details?id=org.toshi"}}},provider:{}},{info:{icon:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjMzIiB2aWV3Qm94PSIwIDAgMzUgMzMiIHdpZHRoPSIzNSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjI1Ij48cGF0aCBkPSJtMzIuOTU4MiAxLTEzLjEzNDEgOS43MTgzIDIuNDQyNC01LjcyNzMxeiIgZmlsbD0iI2UxNzcyNiIgc3Ryb2tlPSIjZTE3NzI2Ii8+PGcgZmlsbD0iI2UyNzYyNSIgc3Ryb2tlPSIjZTI3NjI1Ij48cGF0aCBkPSJtMi42NjI5NiAxIDEzLjAxNzE0IDkuODA5LTIuMzI1NC01LjgxODAyeiIvPjxwYXRoIGQ9Im0yOC4yMjk1IDIzLjUzMzUtMy40OTQ3IDUuMzM4NiA3LjQ4MjkgMi4wNjAzIDIuMTQzNi03LjI4MjN6Ii8+PHBhdGggZD0ibTEuMjcyODEgMjMuNjUwMSAyLjEzMDU1IDcuMjgyMyA3LjQ2OTk0LTIuMDYwMy0zLjQ4MTY2LTUuMzM4NnoiLz48cGF0aCBkPSJtMTAuNDcwNiAxNC41MTQ5LTIuMDc4NiAzLjEzNTggNy40MDUuMzM2OS0uMjQ2OS03Ljk2OXoiLz48cGF0aCBkPSJtMjUuMTUwNSAxNC41MTQ5LTUuMTU3NS00LjU4NzA0LS4xNjg4IDguMDU5NzQgNy40MDQ5LS4zMzY5eiIvPjxwYXRoIGQ9Im0xMC44NzMzIDI4Ljg3MjEgNC40ODE5LTIuMTYzOS0zLjg1ODMtMy4wMDYyeiIvPjxwYXRoIGQ9Im0yMC4yNjU5IDI2LjcwODIgNC40Njg5IDIuMTYzOS0uNjEwNS01LjE3MDF6Ii8+PC9nPjxwYXRoIGQ9Im0yNC43MzQ4IDI4Ljg3MjEtNC40NjktMi4xNjM5LjM2MzggMi45MDI1LS4wMzkgMS4yMzF6IiBmaWxsPSIjZDViZmIyIiBzdHJva2U9IiNkNWJmYjIiLz48cGF0aCBkPSJtMTAuODczMiAyOC44NzIxIDQuMTU3MiAxLjk2OTYtLjAyNi0xLjIzMS4zNTA4LTIuOTAyNXoiIGZpbGw9IiNkNWJmYjIiIHN0cm9rZT0iI2Q1YmZiMiIvPjxwYXRoIGQ9Im0xNS4xMDg0IDIxLjc4NDItMy43MTU1LTEuMDg4NCAyLjYyNDMtMS4yMDUxeiIgZmlsbD0iIzIzMzQ0NyIgc3Ryb2tlPSIjMjMzNDQ3Ii8+PHBhdGggZD0ibTIwLjUxMjYgMjEuNzg0MiAxLjA5MTMtMi4yOTM1IDIuNjM3MiAxLjIwNTF6IiBmaWxsPSIjMjMzNDQ3IiBzdHJva2U9IiMyMzM0NDciLz48cGF0aCBkPSJtMTAuODczMyAyOC44NzIxLjY0OTUtNS4zMzg2LTQuMTMxMTcuMTE2N3oiIGZpbGw9IiNjYzYyMjgiIHN0cm9rZT0iI2NjNjIyOCIvPjxwYXRoIGQ9Im0yNC4wOTgyIDIzLjUzMzUuNjM2NiA1LjMzODYgMy40OTQ2LTUuMjIxOXoiIGZpbGw9IiNjYzYyMjgiIHN0cm9rZT0iI2NjNjIyOCIvPjxwYXRoIGQ9Im0yNy4yMjkxIDE3LjY1MDctNy40MDUuMzM2OS42ODg1IDMuNzk2NiAxLjA5MTMtMi4yOTM1IDIuNjM3MiAxLjIwNTF6IiBmaWxsPSIjY2M2MjI4IiBzdHJva2U9IiNjYzYyMjgiLz48cGF0aCBkPSJtMTEuMzkyOSAyMC42OTU4IDIuNjI0Mi0xLjIwNTEgMS4wOTEzIDIuMjkzNS42ODg1LTMuNzk2Ni03LjQwNDk1LS4zMzY5eiIgZmlsbD0iI2NjNjIyOCIgc3Ryb2tlPSIjY2M2MjI4Ii8+PHBhdGggZD0ibTguMzkyIDE3LjY1MDcgMy4xMDQ5IDYuMDUxMy0uMTAzOS0zLjAwNjJ6IiBmaWxsPSIjZTI3NTI1IiBzdHJva2U9IiNlMjc1MjUiLz48cGF0aCBkPSJtMjQuMjQxMiAyMC42OTU4LS4xMTY5IDMuMDA2MiAzLjEwNDktNi4wNTEzeiIgZmlsbD0iI2UyNzUyNSIgc3Ryb2tlPSIjZTI3NTI1Ii8+PHBhdGggZD0ibTE1Ljc5NyAxNy45ODc2LS42ODg2IDMuNzk2Ny44NzA0IDQuNDgzMy4xOTQ5LTUuOTA4N3oiIGZpbGw9IiNlMjc1MjUiIHN0cm9rZT0iI2UyNzUyNSIvPjxwYXRoIGQ9Im0xOS44MjQyIDE3Ljk4NzYtLjM2MzggMi4zNTg0LjE4MTkgNS45MjE2Ljg3MDQtNC40ODMzeiIgZmlsbD0iI2UyNzUyNSIgc3Ryb2tlPSIjZTI3NTI1Ii8+PHBhdGggZD0ibTIwLjUxMjcgMjEuNzg0Mi0uODcwNCA0LjQ4MzQuNjIzNi40NDA2IDMuODU4NC0zLjAwNjIuMTE2OS0zLjAwNjJ6IiBmaWxsPSIjZjU4NDFmIiBzdHJva2U9IiNmNTg0MWYiLz48cGF0aCBkPSJtMTEuMzkyOSAyMC42OTU4LjEwNCAzLjAwNjIgMy44NTgzIDMuMDA2Mi42MjM2LS40NDA2LS44NzA0LTQuNDgzNHoiIGZpbGw9IiNmNTg0MWYiIHN0cm9rZT0iI2Y1ODQxZiIvPjxwYXRoIGQ9Im0yMC41OTA2IDMwLjg0MTcuMDM5LTEuMjMxLS4zMzc4LS4yODUxaC00Ljk2MjZsLS4zMjQ4LjI4NTEuMDI2IDEuMjMxLTQuMTU3Mi0xLjk2OTYgMS40NTUxIDEuMTkyMSAyLjk0ODkgMi4wMzQ0aDUuMDUzNmwyLjk2Mi0yLjAzNDQgMS40NDItMS4xOTIxeiIgZmlsbD0iI2MwYWM5ZCIgc3Ryb2tlPSIjYzBhYzlkIi8+PHBhdGggZD0ibTIwLjI2NTkgMjYuNzA4Mi0uNjIzNi0uNDQwNmgtMy42NjM1bC0uNjIzNi40NDA2LS4zNTA4IDIuOTAyNS4zMjQ4LS4yODUxaDQuOTYyNmwuMzM3OC4yODUxeiIgZmlsbD0iIzE2MTYxNiIgc3Ryb2tlPSIjMTYxNjE2Ii8+PHBhdGggZD0ibTMzLjUxNjggMTEuMzUzMiAxLjEwNDMtNS4zNjQ0Ny0xLjY2MjktNC45ODg3My0xMi42OTIzIDkuMzk0NCA0Ljg4NDYgNC4xMjA1IDYuODk4MyAyLjAwODUgMS41Mi0xLjc3NTItLjY2MjYtLjQ3OTUgMS4wNTIzLS45NTg4LS44MDU0LS42MjIgMS4wNTIzLS44MDM0eiIgZmlsbD0iIzc2M2UxYSIgc3Ryb2tlPSIjNzYzZTFhIi8+PHBhdGggZD0ibTEgNS45ODg3MyAxLjExNzI0IDUuMzY0NDctLjcxNDUxLjUzMTMgMS4wNjUyNy44MDM0LS44MDU0NS42MjIgMS4wNTIyOC45NTg4LS42NjI1NS40Nzk1IDEuNTE5OTcgMS43NzUyIDYuODk4MzUtMi4wMDg1IDQuODg0Ni00LjEyMDUtMTIuNjkyMzMtOS4zOTQ0eiIgZmlsbD0iIzc2M2UxYSIgc3Ryb2tlPSIjNzYzZTFhIi8+PHBhdGggZD0ibTMyLjA0ODkgMTYuNTIzNC02Ljg5ODMtMi4wMDg1IDIuMDc4NiAzLjEzNTgtMy4xMDQ5IDYuMDUxMyA0LjEwNTItLjA1MTloNi4xMzE4eiIgZmlsbD0iI2Y1ODQxZiIgc3Ryb2tlPSIjZjU4NDFmIi8+PHBhdGggZD0ibTEwLjQ3MDUgMTQuNTE0OS02Ljg5ODI4IDIuMDA4NS0yLjI5OTQ0IDcuMTI2N2g2LjExODgzbDQuMTA1MTkuMDUxOS0zLjEwNDg3LTYuMDUxM3oiIGZpbGw9IiNmNTg0MWYiIHN0cm9rZT0iI2Y1ODQxZiIvPjxwYXRoIGQ9Im0xOS44MjQxIDE3Ljk4NzYuNDQxNy03LjU5MzIgMi4wMDA3LTUuNDAzNGgtOC45MTE5bDIuMDAwNiA1LjQwMzQuNDQxNyA3LjU5MzIuMTY4OSAyLjM4NDIuMDEzIDUuODk1OGgzLjY2MzVsLjAxMy01Ljg5NTh6IiBmaWxsPSIjZjU4NDFmIiBzdHJva2U9IiNmNTg0MWYiLz48L2c+PC9zdmc+",name:"MetaMask",rdns:"io.metamask",uuid:"974b295e-a371-4e37-a428-b82abf69ec3c",onboard:{bool:!0,link:"https://metamask.io/",deeplink:"metamask://",fallback:{ios:"https://apps.apple.com/us/app/metamask-blockchain-wallet/id1438144202",android:"https://play.google.com/store/apps/details?id=io.metamask&pli=1"}}},provider:{}}],o=["function latestRoundData() view returns (uint80 roundId, int256 answer, uint256 startedAt, uint256 updatedAt, uint80 answeredInRound)"],a=["function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 amount) returns (bool)","function balanceOf(address account) view returns (uint256)","function decimals() view returns (uint8)","function name() view returns (string)","function symbol() view returns (string)","function totalSupply() view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)"],s=["function getReserves() view returns (uint112 _reserve0, uint112 _reserve1, uint32 _blockTimestampLast)","function token0() view returns (address)","function token1() view returns (address)","function totalSupply() view returns (uint256)","function balanceOf(address owner) view returns (uint256)","function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 value) returns (bool)","function transfer(address to, uint256 value) returns (bool)","function transferFrom(address from, address to, uint256 value) returns (bool)"],c=["function slot0() view returns (uint160 sqrtPriceX96, int24 tick, uint16 observationIndex, uint16 observationCardinality, uint16 observationCardinalityNext, uint8 feeProtocol, bool unlocked)","function token0() view returns (address)","function token1() view returns (address)","function fee() view returns (uint24)","function decimals() view returns (uint8)","function liquidity() view returns (uint128)"],l=["none","custom","default","light"],d=["none","custom","connect","provider"],u=["none","custom","log","connect"],h={validateInput:function(e,t,n="validateInput"){if("object"!=typeof e)throw new TypeError(`${n}: "inputs" must be a valid object.`);if("object"!=typeof t)throw new TypeError(`${n}: "rules" must be a valid object.`);if("string"!=typeof n)throw new TypeError(`${n}: "context" must be a valid string.`);return Object.entries(t).forEach((([t,i])=>{const r=e[t];if(i.required&&null==r)throw new Error(`${n}: "${t}" is required.`);if(i.required||null!=r){if("array"===i.type){if(!Array.isArray(r))throw new TypeError(`${n}: Validation failed: "${t}" must be an array.`);if(i.items&&r.forEach(((e,r)=>{if(i.items.type&&typeof e!==i.items.type)throw new TypeError(`${n}: Validation failed: "${t}[${r}]" must be of type "${i.items.type}", but received type "${typeof e}".`);if(i.items.regex&&!i.items.regex.test(e))throw new Error(`${n}: Validation failed: "${t}[${r}]" must match the pattern "${i.items.regex}".`);if(i.items.values&&!i.items.values.includes(e))throw new Error(`${n}: Validation failed: "${t}[${r}]" must be one of [${i.items.values}].`)})),i.length){if(void 0!==i.length.min&&r.length<i.length.min)throw new Error(`${n}: Validation failed: "${t}" must have a minimum length of ${i.length.min}, but got ${r.length}.`);if(void 0!==i.length.max&&r.length>i.length.max)throw new Error(`${n}: Validation failed: "${t}" must have a maximum length of ${i.length.max}, but got ${r.length}.`)}}else if(i.type&&typeof r!==i.type)throw new TypeError(`${n}: Validation failed: "${t}" must be of type "${i.type}", but received type "${typeof r}".`);if(i.regex&&!i.regex.test(r))throw new Error(`${n}: Validation failed: "${t}" must match the pattern "${i.regex}".`);if(i.values&&!i.values.includes(r))throw new Error(`${n}: Validation failed: "${t}" must be one of [${i.values}].`);if(i.enum&&!i.enum.includes(r))throw new Error(`${n}: Validation failed: "${t}" must be one of [${i.enum}].`);if(i.range&&(r<i.range.min||r>i.range.max))throw new RangeError(`${n}: Validation failed: "${t}" must be within the range [${i.range.min}, ${i.range.max}].`);if(i.length){const e=r.length;if("number"!=typeof e)throw new TypeError(`${n}: "${t}" must have a valid length property.`);if("number"==typeof i.length&&e!==i.length)throw new Error(`${n}: "${t}" must have a length of ${i.length}, but got ${e}.`);if("object"==typeof i.length){if(void 0!==i.length.min&&e<i.length.min)throw new Error(`${n}: "${t}" must have a minimum length of ${i.length.min}, but got ${e}.`);if(void 0!==i.length.max&&e>i.length.max)throw new Error(`${n}: "${t}" must have a maximum length of ${i.length.max}, but got ${e}.`)}}}})),!0},validateChain:function(e){if(!this.validateInput({chain:e},{chain:{required:!0,type:"string"}},"CryptoModule.validateChain"))return null;const t=n[e];if(!t)throw new Error(`CryptoModule.validateChain: Chain "${e}" is not supported.`);const i=t.params[0]?.chainId;if(!i)throw new Error(`CryptoModule.validateChain: Missing chainId for chain "${e}".`);return{chainData:t,chainId:i}}},p={initLogger:function(){const e=document.querySelector("#log-modal"),t=document.querySelector("#log-mc"),n=document.querySelector("#log-mt"),i=console.log,r=console.error;function o(e){const n=document.createElement("div");n.className="log-item",e.forEach((e=>{Array.isArray(e)?e.forEach((e=>a(e,n))):a(e,n)})),t&&(t.appendChild(n),t.scrollTop=t.scrollHeight)}function a(e,t){const n=document.createElement("div");if(e instanceof Error)t.classList.add("log-error"),n.className="log-object error-object",n.innerHTML=`<pre>${c(s({message:e.message,name:e.name,stack:e.stack},2))}</pre>`;else if(e instanceof HTMLElement)n.className="log-dom",n.innerHTML=`<pre>&lt;${e.tagName.toLowerCase()} id="${e.id}" class="${e.className}"&gt;</pre>`;else if("object"==typeof e&&null!==e){n.className="log-object";try{n.innerHTML=`<pre>${c(s(e,2))}</pre>`}catch(e){n.textContent=`[Unserializable object: ${e.message}]`}}else"string"==typeof e?(n.className=l(e)?"log-address":"log-string",n.textContent=e):"number"==typeof e?(n.className="log-number",n.textContent=e.toString()):(n.className="log-unknown",n.textContent=String(e));t.appendChild(n)}function s(e,t=2){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if("object"==typeof t&&null!==t){if(n.has(t))return"[Circular]";n.add(t)}return t}),t)}function c(e){return e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(\.\d+)?([eE][+-]?\d+)?)/g,(e=>{let t="log-number";return/^"/.test(e)?t=/:$/.test(e)?"log-key":l(e.replace(/"/g,""))?"log-address":"log-string":/true|false/.test(e)?t="log-boolean":/null/.test(e)&&(t="log-null"),`<span class="${t}">${e}</span>`}))}function l(e){return/^0x[a-fA-F0-9]{40}$/.test(e)}function d(){e&&t&&n&&(t.classList.contains("lc-hide")?(t.classList.remove("lc-hide"),t.classList.add("lc-show"),n.innerHTML='<i class="fa-solid fa-caret-left"></i>',e.classList.remove("lm-hide"),e.classList.add("lm-show")):(t.classList.remove("lc-show"),t.classList.add("lc-hide"),n.innerHTML='<i class="fa-solid fa-caret-right"></i>',e.classList.remove("lm-show"),e.classList.add("lm-hide")))}console.log=function(...e){i.apply(console,e),o(e)},console.error=function(...e){r.apply(console,e),o(e)},window.onerror=function(e,t,n,i,r){o([`Error: ${e} at ${t}:${n}:${i}`,r])},window.addEventListener("unhandledrejection",(function(e){o(["Unhandled Promise Rejection:",e.reason])})),n&&n.addEventListener("click",d),d()}},m={truncate:function(e,t=6,n=4){return sypher.validateInput({string:e,startLength:t,endLength:n},{string:{type:"string",required:!0},startLength:{type:"number",required:!1},endLength:{type:"number",required:!1}},"TruncationModule.truncate")?e.length<=t+n+3?e:`${e.slice(0,t)}...${e.slice(-n)}`:null},truncateBalance:function(e,t=2,n=8){if(!sypher.validateInput({balance:e,decimals:t,maxLength:n},{balance:{type:"number",required:!0},decimals:{type:"number",required:!1},maxLength:{type:"number",required:!1}},"TruncationModule.truncateBalance"))return null;const i=parseFloat(e.toString());if(i>=1e15)return`${(i/1e15).toFixed(t)}Q`;if(i>=1e12)return`${(i/1e12).toFixed(t)}T`;if(i>=1e9)return`${(i/1e9).toFixed(t)}B`;if(i>=1e6)return`${(i/1e6).toFixed(t)}M`;if(i>=1e3)return`${(i/1e3).toFixed(t)}K`;const[r,o=""]=i.toString().split(".");if(r.length>=n)return r;const a=n-r.length-1,s=o.slice(0,Math.max(a,0));return s?`${r}.${s}`:r}},g={pageFocus:function(){const e="visible"===document.visibilityState;return e?console.log("Page Focused..."):console.log("Page Unfocused..."),e},userEnvironment:function(){const e=navigator.userAgent||navigator.vendor,t=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|Windows Phone|webOS/i.test(e),n=/iPad|Tablet/i.test(e),i=!t&&!n,r={width:window.screen.width,height:window.screen.height,availableWidth:window.screen.availWidth,availableHeight:window.screen.availHeight,colorDepth:window.screen.colorDepth,pixelDepth:window.screen.pixelDepth};return{isMobile:t,isTablet:n,isDesktop:i,deviceType:t?n?"Tablet":"Mobile":"Desktop",browser:(()=>{const t=e.toLowerCase();return/chrome|crios|crmo/i.test(t)&&!/edge|opr\//i.test(t)?"Chrome":/firefox|fxios/i.test(t)?"Firefox":/safari/i.test(t)&&!/chrome|crios|crmo|opr\//i.test(t)?"Safari":/opr\//i.test(t)?"Opera":/edg/i.test(t)?"Edge":/msie|trident/i.test(t)?"Internet Explorer":"Unknown"})(),operatingSystem:/windows phone/i.test(e)?"Windows Phone":/win/i.test(e)?"Windows":/android/i.test(e)?"Android":/mac/i.test(e)?"MacOS":/iphone|ipad|ipod/i.test(e)?"iOS":/linux/i.test(e)?"Linux":"Unknown",userAgent:e,ethereum:"ethereum"in window&&void 0!==window.ethereum,platform:navigator.platform,languages:navigator.languages||[navigator.language],cookiesEnabled:navigator.cookieEnabled,screenDetails:r,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}}},y={initTheme:function(e="default"){if(!sypher.validateInput({theme:e},{theme:{type:"string",required:!0}},"InterfaceModule.initTheme"))return;if(this._theme)return;"none"===e&&(e="custom");const t=`sypher-${e}-theme`;if(!document.getElementById(t)){const n=document.createElement("link");n.id=t,n.rel="stylesheet",n.href=`/dist/css/themes/sypher-${e}-theme.css`,document.head.appendChild(n),this._theme=e}},applyStyle:function(e,t){if(!sypher.validateInput({elements:e,...t},{elements:{type:"array",required:!0},type:{type:"string",required:!0},theme:{type:"string",required:!0}},"InterfaceModule.applyStyle"))return;const n=t.type;let i=t.theme;"none"===i&&(i="custom"),this._theme||this.initTheme(i);const r=`sypher-${n}`;if(!document.getElementById(r)){const e=document.createElement("link");e.id=r,e.rel="stylesheet",e.href=`/dist/css/sypher-${n}.css`,document.head.appendChild(e)}},createButton:function(e){const t={type:"connect",text:"Connect Wallet",icon:"",modal:!1,theme:"none",append:document.body,onClick:()=>sypher.connect("ethereum"),initCrypto:{}},n={...t,...e},{type:i,text:r,icon:o,modal:a,theme:s,append:c,onClick:u,initCrypto:h}=n;if(!d.includes(i))throw new Error(`InterfaceModule.createModal: Type '${i}' not found.`);if(!l.includes(s))throw new Error(`InterfaceModule.createModal: Theme '${s}' not found.`);let p=this._theme||s;"none"===s&&(p="custom");let m=i;"none"===i&&(m="custom");const g={type:i,theme:p};if(!g)return null;if("connect"===m){if("none"===h.chain)throw new Error("InterfaceModule.createButton: Chain is required for type 'connect'.");const e=`${m}-button`,n=`${p}-button`,i=`${m}-button`;let o=document.getElementById(i);o||(o=document.createElement("button"),o.id=i,c.appendChild(o)),o.classList.add(e,n),o.textContent=r,this._connectText=r;const s=u===t.onClick?()=>sypher.connect("none"!==h.chain?h.chain:"ethereum"):u;return a?(console.log("Modal Enabled..."),o.onclick=()=>this.createModal({append:document.body,type:"connect",theme:p,initCrypto:h}),sypher.initProviderSearch()):o.onclick=s,this.applyStyle([o],g),o}if("provider"===m){if("none"===h.chain)throw new Error("InterfaceModule.createButton: Chain is required for type 'provider'.");const e=document.createElement("div");e.id=r.toLowerCase().replace(/\s+/g,"-"),e.classList.add("connect-mi"),e.addEventListener("click",u);const t=document.createElement("img");t.classList.add("connect-mim"),t.src=o;const n=document.createElement("span");return n.classList.add("connect-min"),n.innerText=r,this.applyStyle([e,t,n],g),c.appendChild(e),e.appendChild(t),e.appendChild(n),e}return null},createModal:async function(e){const t={...{append:document.body,type:"none",theme:"none",initCrypto:{}},...e};if(!sypher.validateInput({...t},{append:{type:"object",required:!1},type:{type:"string",required:!0},theme:{type:"string",required:!1}},"InterfaceModule.createModal"))return null;const{append:n,type:o,theme:a,initCrypto:s}=t;if(!u.includes(o))throw new Error(`InterfaceModule.createModal: Type '${o}' not found.`);if(!l.includes(a))throw new Error(`InterfaceModule.createModal: Theme '${a}' not found.`);let c=this._theme||a;if("none"===a&&(c="custom"),"none"===o)return null;const d=this.initModal(o,c);if(!d)return null;if("log"===d.type)return this.applyStyle([d.parent,d.container,d.toggle],t),n.appendChild(d.parent),d.parent.appendChild(d.container),d.parent.appendChild(d.toggle),sypher.initLogger(),d;if("connect"===d.type){this.applyStyle([d.parent,d.container,d.toggle,d.head,d.title,d.body],t),d.parent.addEventListener("click",(e=>{e.target===d.parent&&d.parent.remove()})),n.appendChild(d.parent),d.parent.appendChild(d.container),d.container.appendChild(d.head),d.head.appendChild(d.title),d.head.appendChild(d.toggle),d.container.appendChild(d.body);const e=[...r.map((e=>{const t=i.find((t=>t.info.name===e.info.name)),n=t||e;return t&&(n.info.onboard||(n.info.onboard={bool:!1,link:"",deeplink:"",fallback:{ios:"",android:""}}),n.info.onboard.bool=!1),n})),...i.filter((e=>!r.some((t=>t.info.name===e.info.name))))],o=sypher.getConnected();if(e.forEach((e=>{const{name:t,icon:n}=e.info,i=e.info.onboard?.bool?()=>{sypher.onboard(e)}:()=>{"none"!==s.chain?sypher.initCrypto({chain:s.chain,contractAddress:s.contractAddress,poolAddress:s.poolAddress,version:s.version,detail:e,icon:s.icon}):sypher.connect(s.chain,e)},r=this.createButton({append:d.body,type:"provider",text:t,icon:n,modal:!1,theme:c,onClick:i,initCrypto:s});null!==r&&null!=o&&(r.style.display="none")})),null!=o){d.title.innerHTML="Account";const t=sypher.getProvider(),n=new ethers.providers.Web3Provider(t).getSigner(),i=await n.getBalance(),r=ethers.utils.formatEther(i),a=sypher.getCleaned();let s=!1,c="av-b-c-hide",l="",u="",h=0,p="",m=0;a&&(s=!0,c="av-b-c",l=a.icon||"",u=a.name||"",h=a.balance||0,p=a.userValue||"",m=a.tokenPrice||0,a.decimals);const g=this.createElement({append:d.body,type:"div",id:"account-view",children:[{type:"div",classes:["av-h"],children:[{type:"h2",classes:["av-h-ti"],innerHTML:`${sypher.truncate(o)}`},{type:"h3",classes:["av-h-ba"],innerHTML:`${sypher.truncateBalance(parseFloat(r.toString()))} ETH`}]},{type:"div",classes:["av-b"],children:[{type:"div",id:"av-b-td",classes:[c],children:[{type:"div",classes:["av-b-td-ic"],children:[{type:"img",classes:["av-b-td-i"],attributes:{src:l}},{type:"div",classes:["av-b-td-n"],innerHTML:s?`$${sypher.truncateBalance(parseFloat(m.toString()))}`:""}]},{type:"div",classes:["av-b-td-bal"],innerHTML:s?`${sypher.truncateBalance(parseFloat(h.toString()))} ${u}`:""},{type:"div",classes:["av-b-td-val"],innerHTML:s?`$${sypher.truncateBalance(parseFloat(p.toString()))}`:""}]},{type:"div",id:"av-b-provider",classes:["av-b-b"],events:{click:()=>{g&&(g.style.display="none");const e=document.querySelectorAll(".connect-mi");e&&e.forEach((e=>{e.style.display="flex"})),d.title.innerHTML="Change Wallet"}},children:[{type:"div",classes:["av-b-bn-ic"],children:[{type:"img",classes:["av-b-bn-i"],attributes:{src:e[0].info.icon}},{type:"img",classes:["av-b-bn-i"],attributes:{src:e[1].info.icon}}]},{type:"div",classes:["av-b-bn-t"],innerHTML:"Change Wallet"}]}]},{type:"div",classes:["av-x"],events:{click:()=>{sypher.disconnect(),g&&g.parentNode&&g.parentNode.removeChild(g);const e=document.querySelectorAll(".connect-mi");e&&e.forEach((e=>{e.style.display="flex"}));const t=document.getElementById("connect-button");t&&this._connectText&&(t.innerHTML=this._connectText),d.title.innerHTML="Connect Wallet"}},innerHTML:"Disconnect"}]});if(!g)return null}return d}return null},initModal:function(e,t="custom"){if(!sypher.validateInput({type:e},{type:{type:"string",required:!0},theme:{type:"string",required:!1}},"InterfaceModule.initModal"))return null;if("none"===e||"custom"===e)return null;if("log"===e){const n=document.createElement("div");n.id=`${e}-modal`,n.classList.add(`${t}-modal`);const i=document.createElement("div");i.id=`${e}-mc`,i.classList.add(`${t}-mc`);const r=document.createElement("div");r.id=`${e}-mt`,r.classList.add(`${t}-mt`);return{type:e,parent:n,container:i,toggle:r}}if("connect"===e){const n=document.createElement("div");n.id=`${e}-modal`,n.classList.add(`${t}-modal`);const i=document.createElement("div");i.id=`${e}-mc`,i.classList.add(`${t}-mc`);const r=document.createElement("div");r.id=`${e}-mh`,r.classList.add(`${t}-mh`);const o=document.createElement("img");o.id=`${e}-mx`,o.classList.add(`${t}-mx`),o.src="https://raw.githubusercontent.com/leungwensen/svg-icon/8b84d725b0d2be8f5d87cac7f2c386682ce43563/dist/svg/zero/close-c.svg",o.addEventListener("click",(()=>{n.remove()}));const a=document.createElement("h2");a.id=`${e}-mt`,a.classList.add(`${t}-mt`),a.innerText="Connect Wallet";const s=document.createElement("div");s.id=`${e}-mb`,s.classList.add(`${t}-mb`);return{type:e,parent:n,container:i,toggle:o,head:r,title:a,body:s}}return null},createElement:function(e){const t={...{append:document.body,type:"div",id:"",classes:[],attributes:{},events:{},innerHTML:"",children:[]},...e},{append:n,type:i,id:r,theme:o,classes:a,attributes:s,events:c,innerHTML:d,children:u}=t;if(o&&!l.includes(o))throw new Error(`InterfaceModule.createElement: Theme '${o}' not found.`);let h=this._theme||o;"none"===o&&(h="custom");const p=document.createElement(i);if(r&&""!==r&&(p.id=r),p.classList.add(`sypher-${h}-element`),a&&a.forEach((e=>{p.classList.add(e)})),s)for(const[e,t]of Object.entries(s))p.setAttribute(e,t);if(c)for(const[e,t]of Object.entries(c))p.addEventListener(e,t);return d&&""!==d&&(p.innerHTML=d),u&&u.forEach((e=>{const t=this.createElement(e);t&&p.appendChild(t)})),n&&n.appendChild(p),p},toggleLoader:function(e){const t={...{element:document.body,isEnabled:!0,newText:"",loaderHTML:'<div class="loader"></div>',replace:!0},...e},{element:n,isEnabled:i,newText:r,loaderHTML:o,replace:a}=t;if(i){if(a)n.innerHTML=o;else if(!n.querySelector(".loader")){const e=document.createElement("div");e.classList.add("loader"),n.appendChild(e)}}else{if("sypher.revert"===r){const e=n.querySelector(".loader");return void(e&&e.remove())}n.innerHTML=r}},parallax:function(){const e=document.querySelectorAll("[data-speed]");function t(){e.forEach((e=>{const t=parseFloat(e.dataset.speed||"0.5"),n=window.scrollY*t;e.style.transform=`translateY(${-n}px)`}))}0!==e.length?(console.log("Parallax enabled on ",e.length," elements."),window.addEventListener("scroll",(function(){requestAnimationFrame(t)})),t()):console.warn("InterfaceModule.parallax: Parallax enabled, but no elements found with the [data-speed] attribute.")},fade:function(e="20px",t="0.5s"){if(!sypher.validateInput({distance:e,length:t},{distance:{type:"string",required:!1},length:{type:"string",required:!1}},"InterfaceModule.fade"))return;const n=document.querySelectorAll("[data-fade]");if(0===n.length)return void console.warn("InterfaceModule.fade: Fade enabled, but no elements found with the [data-fade] attribute.");console.log("Fade enabled on ",n.length," elements."),n.forEach((n=>{n.style.opacity="0",n.style.transform=`translateY(${e})`,n.style.transition=`opacity ${t} ease-out, transform ${t} ease-out`}));const i=new IntersectionObserver((t=>{t.forEach((t=>{const n=t.target;t.isIntersecting&&t.intersectionRatio>.1?(n.style.opacity="1",n.style.transform="translateY(0)"):(n.style.opacity="0",n.style.transform=`translateY(${e})`)}))}),{threshold:.1});n.forEach((e=>i.observe(e)))},getUI:function(){return{theme:this._theme||"",connectText:this._connectText||""}}},f={initCrypto:async function(e){const t={chain:"ethereum",contractAddress:"",poolAddress:"",version:"V2",pair:"eth",...e};if(!t)return null;this.flush();const n=sypher.validateChain(t.chain);if(!n)return null;const{chainData:i,chainId:r}=n;if(!i||!r)return null;try{if(!await this.connect(t.chain,t.detail))return null;console.log("Getting details for:",t);const e=await this.getTokenDetails(t.chain,t.contractAddress);if(!e)return null;const{balance:n,decimals:i,name:r,symbol:o,totalSupply:a}=e;let s;if("V2"===t.version){const e=await this.getPriceV2(t.chain,t.poolAddress,t.pair);if(!e)return null;s=e}else{if("V3"!==t.version)return null;{const e=await this.getPriceV3(t.chain,t.contractAddress,t.poolAddress,t.pair);if(!e)return null;s=e}}const c=this.getUserValue(n,s);if(null==c)return null;const l=t.contractAddress,d=t.poolAddress,u=t.icon??"",h=t.version,p={contractAddress:l,poolAddress:d,balance:n,decimals:i,name:r,symbol:o,icon:u,totalSupply:a,tokenPrice:s,userValue:c,version:h,pair:t.pair};if(!p)return null;const m=this.clean(p);if(!m)return null;const g=m;return window.dispatchEvent(new CustomEvent("sypher:initCrypto",{detail:g})),g}catch(e){throw new Error(`CryptoModule.initCrypto: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},connect:async function(e,t=null){if(!sypher.validateInput({chain:e},{chain:{type:"string",required:!0}},"CryptoModule.connect"))return null;console.log("Chain: ",e,"Detail: ",t);const n=document.getElementById("connect-button")||null,i=this.getProvider();if(!i)return null;const r=t||this._EIP6963;if(this._connected&&!r)return this._connected;if(r){const t=document.querySelectorAll(".connect-mi"),i=document.getElementById("connect-mb"),o=document.getElementById("connect-mc"),a=document.getElementById("connect-modal");if(t.length>0&&t.forEach((e=>{e.style.display="none"})),i){const e={element:i,loaderHTML:"<div class='loader'></div>",isEnabled:!0,replace:!1};sypher.toggleLoader(e)}this._EIP6963=r;try{const t=r.provider;console.log("[EIP-6963] Using provider:",r.info.name);const s=await t.request({method:"eth_requestAccounts"});if(!Array.isArray(s)||!s.length)throw new Error("No accounts returned by the chosen provider.");const c=s[0];return console.log("[EIP-6963] Connected account:",c),await this.switchChain(e),this._connected=c,console.log("Connected account:",c),i&&(i.innerHTML=`\n                        <div class="connect-sb">\n                            <p class="connect-s">Connected to ${r.info.name}</p>\n                            <p class="connect-s">Account: <span class="sypher-a">${sypher.truncate(c)}</span></p>\n                        </div>\n                    `,i.classList.add("min-height-a")),o&&o.classList.add("height-a"),a&&(setTimeout((()=>{a.style.opacity="0%"}),5e3),setTimeout((()=>{a.remove()}),6e3)),null!==n&&(n.innerHTML=`${sypher.truncate(c)}`),window.dispatchEvent(new CustomEvent("sypher:connect",{detail:c})),this.accountChange(!0),c}catch(e){const n=e instanceof Error?`${e.message}\n${e.stack}`:JSON.stringify(e,Object.getOwnPropertyNames(e));if(4001===e.code){if(console.log("User denied wallet access..."),window.dispatchEvent(new CustomEvent("sypher:connectFail",{detail:"User denied wallet access"})),i){const e={element:i,isEnabled:!1,newText:"sypher.revert"};sypher.toggleLoader(e)}return void t.forEach((e=>{e.style.display="flex"}))}throw new Error(`CryptoModule.connect: ${n}`)}}else try{const t=await i.request({method:"eth_requestAccounts"});if(!Array.isArray(t)||0===t.length)throw new Error("CryptoModule.connect: No accounts returned by the Ethereum provider.");const r=t[0];return r?(await this.switchChain(e),this._connected=r,console.log("Connected account:",r),null!==n&&(n.innerHTML=`${sypher.truncate(r)}`),window.dispatchEvent(new CustomEvent("sypher:connect",{detail:r})),this.accountChange(!0),r):(console.warn("CryptoModule.connect: Wallet not connected."),null)}catch(e){const t=e instanceof Error?`${e.message}\n${e.stack}`:JSON.stringify(e,Object.getOwnPropertyNames(e));throw new Error(`CryptoModule.connect: ${t}`)}},disconnect:async function(){this._connected=void 0,this._token=void 0,window.dispatchEvent(new CustomEvent("sypher:disconnect",{detail:this._connected})),this.accountChange(!1)},accountChange:function(e){let t=this._EIP6963?.provider;if(t||(t=this.getProvider()),null!==this._connected&&void 0!==this._connected)if(e)console.log("Listening for account changes..."),t.on("accountsChanged",(e=>{if(!e.length)return void this.disconnect();this._connected=e[0],window.dispatchEvent(new CustomEvent("sypher:accountChange",{detail:this.getConnected()}));const t=document.getElementById("connect-modal");t&&t.remove(),this._connected=void 0,this._chain&&(this._token?this._EIP6963?this.initCrypto({chain:this._chain.chainName.toLowerCase(),contractAddress:this._token.contractAddress,poolAddress:this._token.poolAddress,version:this._token.version,pair:this._token.pair,icon:this._token.icon,detail:this._EIP6963}):console.log("Unknown Error Occured..."):this.connect(this._chain.chainId,this._EIP6963))}));else{t.removeAllListeners("accountsChanged");const e=document.getElementById("connect-modal");e&&e.remove()}},onboard:async function(e){const t=sypher.userEnvironment(),n=t.isMobile,i="macos"===t.operatingSystem.toLowerCase(),r="android"===t.operatingSystem.toLowerCase();if(n){if(n){const{deeplink:t,fallback:n}=e.info.onboard;if(!i&&!r)return;{const e=i?"ios":"android",r=setTimeout((()=>{if(console.log("Deeplink failed, prompting user for App Store redirection..."),"ios"===e){confirm("Unable to open the app. Please click confirm to download from the app store.")?window.location.href=n[e]:console.log("User canceled App Store redirection.")}else{const t=document.createElement("a");t.href=n[e],t.target="_self",t.rel="noopener",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}),1e3);window.location.href=t,window.addEventListener("blur",(()=>clearTimeout(r)),{once:!0})}}}else window.open(e.info.onboard.link,"_blank")},switchChain:async function(e){if(!sypher.validateInput({chain:e},{chain:{type:"string",required:!0}},"CryptoModule.switchChain"))return;let t=this._EIP6963?.provider;t||(t=this.getProvider());const n=await this.getChainData(e);if(!n)return;const{chainlistData:i,params:r}=n;if(!i)return;const o=r.chainId;if(this._chain?.chainId!==o){r&&(this._chain=r);try{if(await t.request({method:"eth_chainId"})===o)return void(this._chain&&(this._chain.chainId=o));console.log(`Switching to ${e} chain...`),await t.request({method:"wallet_switchEthereumChain",params:[{chainId:o}]}),this._chain&&(this._chain.chainId=o)}catch(n){if(console.warn(`CryptoModule.switchChain: Attempting to add chain: ${e}`),4902!==n.code)throw new Error(`CryptoModule.switchChain: Unable to switch chain "${e}". Details: ${n}`);try{await t.request({method:"wallet_addEthereumChain",params:[r]}),this._chain&&(this._chain.chainId=o)}catch(t){throw new Error(`CryptoModule.switchChain: Unable to add chain "${e}". Details: ${t}`)}}}},getChainData:async function(e){if(!sypher.validateInput({chain:e},{chain:{type:"string",required:!0}},"CryptoModule.getChainData"))return null;const t=sypher.validateChain(e);if(!t)return null;const{chainData:n,chainId:i}=t;if(!n||!i)return null;try{const e=`https://raw.githubusercontent.com/ethereum-lists/chains/refs/heads/master/_data/chains/eip155-${parseInt(i,16)}.json`,t=await fetch(e);if(!t.ok)throw new Error(`Chain data for ID ${i} not found`);const n=await t.json();console.log("Fetched chain data:",n);const r={chainId:`0x${parseInt(n.chainId,10).toString(16)}`,chainName:n.name.toLowerCase(),nativeCurrency:n.nativeCurrency,rpcUrls:n.rpc,blockExplorerUrls:n.explorers?.map((e=>e.url))||[]};return{chainlistData:n,params:r}}catch(e){throw new Error(`CryptoModule.getChainData: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceFeed:async function(t,i="eth"){if(!sypher.validateInput({chain:t,pair:i},{chain:{type:"string",required:!0},pair:{type:"string",required:!1}},"CryptoModule.getPriceFeed"))return null;if(this._ethPrice&&this._ethPrice.value&&this._ethPrice.timestamp&&Date.now()-this._ethPrice.timestamp<6e4)return this._ethPrice.value;if(!this.getProvider())return null;const r=sypher.validateChain(t);if(!r)return null;const{chainData:a,chainId:s}=r;if(!a||!s)return null;try{let r=this._connected;if(null==r&&(r=await this.connect(t)),!r)return null;const a=n[t].priceFeeds[i];if(!a)throw new Error(`Chain ${t} is not supported`);let s=this._EIP6963?.provider;s||(s=this.getProvider());const c=new e.providers.Web3Provider(s).getSigner(),l=new e.Contract(a,o,c),d=await l.latestRoundData(),u=e.utils.formatUnits(d.answer,8);return console.log(`ETH Price on ${t}: $${u}`),this._ethPrice={value:u,timestamp:Date.now()},u}catch(e){throw new Error(`CryptoModule.getPriceFeed: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getTokenDetails:async function(n,i){if(!sypher.validateInput({chain:n,contractAddress:i},{chain:{type:"string",required:!0},contractAddress:{type:"string",required:!0,regex:t}},"CryptoModule.getTokenDetails"))return null;try{let t=this._connected;if(null==t&&(t=await this.connect(n)),!t)return null;let r=this._EIP6963?.provider;r||(r=this.getProvider());const o=new e.providers.Web3Provider(r).getSigner(),s=new e.Contract(i,a,o),c=await s.balanceOf(t),l=await s.decimals(),d=await s.name(),u=await s.symbol(),h=await s.totalSupply();return console.log("Raw Details:",{balance:c,decimals:l,name:d,symbol:u,totalSupply:h}),{balance:c,decimals:l,name:d,symbol:u,totalSupply:h}}catch(e){throw new Error(`CryptoModule.getTokenDetails: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceV2:async function(i,r,o){if(!sypher.validateInput({chain:i,poolAddress:r,pair:o},{chain:{type:"string",required:!0},poolAddress:{type:"string",required:!0,regex:t},pair:{type:"string",required:!0}},"CryptoModule.getPriceV2"))return null;if(!this.getProvider())return null;const c=sypher.validateChain(i);if(!c)return null;const{chainData:l,chainId:d}=c;if(!l||!d)return null;try{let t=this._connected;if(null==t&&(t=await this.connect(i)),!t)return null;const c=await this.getPriceFeed(i,o);if(!c)return null;let l=this._EIP6963?.provider;l||(l=this.getProvider());const d=new e.providers.Web3Provider(l).getSigner(),u=new e.Contract(r,s,d),h=await u.token0(),p=await u.token1(),m=await u.getReserves(),g=m._reserve0,y=m._reserve1,f=new e.Contract(h,a,d),M=new e.Contract(p,a,d),I=await f.decimals(),w=await M.decimals();console.log("Reserve 0:",g),console.log("Reserve 1:",y),console.log("Token 0:",h),console.log("Token 1:",p),console.log("Decimals 0:",I),console.log("Decimals 1:",w);const b=e.BigNumber.from(g),v=e.BigNumber.from(y),N=parseFloat(e.utils.formatUnits(b,I)),D=parseFloat(e.utils.formatUnits(v,w)),C=n[i].pairAddresses[o];let E;if(console.log("Pair Address:",C),p.toLowerCase()===C.toLowerCase())E=D/N;else{if(h.toLowerCase()!==C.toLowerCase())throw new Error(`CryptoModule.getPriceV2: Neither token is ${o}`);E=N/D}const L=E*parseFloat(c);return console.log(`V2 Price for token in pool ${r}: $${L}`),L}catch(e){throw new Error(`CryptoModule.getPriceV2: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceV3:async function(i,r,o,a){if(!sypher.validateInput({chain:i,contractAddress:r,poolAddress:o,pair:a},{chain:{type:"string",required:!0},contractAddress:{type:"string",required:!0,regex:t},poolAddress:{type:"string",required:!0,regex:t},pair:{type:"string",required:!0}},"CryptoModule.getPriceV3"))return null;if(!this.getProvider())return null;const s=sypher.validateChain(i);if(!s)return null;const{chainData:c,chainId:l}=s;if(!c||!l)return null;try{let t=this._connected;if(null==t&&(t=await this.connect(i)),!t)return null;const s=await this.getPoolV3(i,r,o);if(!s)return null;const{sqrtPriceX96:c,token0:l,token1:d,decimals0:u,decimals1:h}=s,p=n[i].pairAddresses[a];console.log("Pair Address:",p);const m=e.BigNumber.from(c),g=e.BigNumber.from("79228162514264337593543950336"),y=m.mul(m).mul(e.BigNumber.from(10).pow(u)),f=g.mul(g).mul(e.BigNumber.from(10).pow(h)),M=y.div(f),I=y.mod(f),w=8,b=e.BigNumber.from(10).pow(w),v=I.mul(b).div(f),N=parseFloat(M.toString())+parseFloat(v.toString())/Math.pow(10,w);let D;if(d.toLowerCase()===p.toLowerCase())D=N;else{if(l.toLowerCase()!==p.toLowerCase())throw new Error(`CryptoModule.getPriceV3: Neither token is ${a}`);D=1/N}const C=await this.getPriceFeed(i,a);if(!C)return null;const E=D*parseFloat(C);return console.log(`V3 Price for token in pool ${sypher.truncate(o)}: $${E}`),E}catch(e){throw new Error(`CryptoModule.getPriceV3: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPoolV3:async function(n,i,r){if(!sypher.validateInput({chain:n,contractAddress:i,poolAddress:r},{chain:{type:"string",required:!0},contractAddress:{type:"string",required:!0,regex:t},poolAddress:{type:"string",required:!0,regex:t}},"CryptoModule.getPoolV3"))return null;if(!this.getProvider())return null;const o=sypher.validateChain(n);if(!o)return null;const{chainData:s,chainId:l}=o;if(!s||!l)return null;try{let t=this._connected;if(null==t&&(t=await this.connect(n)),!t)return null;let i=this._EIP6963?.provider;i||(i=this.getProvider());const o=new e.providers.Web3Provider(i).getSigner(),s=new e.Contract(r,c,o),l=(await s.slot0()).sqrtPriceX96;console.log("Sqrt Price X96:",l);const d=await s.token0(),u=await s.token1();console.log("Token 0:",d),console.log("Token 1:",u);const h=new e.Contract(d,a,o),p=new e.Contract(u,a,o),m=await h.decimals(),g=await p.decimals();console.log("Decimals 0:",m),console.log("Decimals 1:",g);const y=await s.liquidity();console.log("Liquidity:",y);return{sqrtPriceX96:l,token0:d,token1:u,decimals0:m,decimals1:g,liquidity:y}}catch(e){throw new Error(`CryptoModule.getPoolV3: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getUserValue:function(e,t){if(!sypher.validateInput({balance:e,price:t},{balance:{type:"object",required:!0},price:{type:"number",required:!0}},"CryptoModule.getUserValue"))return null;try{const n=parseFloat(e.toString())*parseFloat(t.toString());return console.log(`User Value: ${n}`),n}catch(e){throw new Error(`CryptoModule.getUserValue: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},clean:function(t){if(!sypher.validateInput({tokenDetails:t},{tokenDetails:{type:"object",required:!0}},"CryptoModule.clean"))return null;const{contractAddress:n,poolAddress:i,balance:r,decimals:o,name:a,symbol:s,icon:c,totalSupply:l,tokenPrice:d,userValue:u,version:h,pair:p}=t,m={contractAddress:n,poolAddress:i,balance:parseFloat(e.utils.formatUnits(r,o)),decimals:o,name:a,symbol:s,icon:c,totalSupply:parseFloat(e.utils.formatUnits(l,o)),tokenPrice:parseFloat(d.toString()),userValue:(parseFloat(u.toString())/Math.pow(10,o)).toFixed(o).toString(),version:h,pair:p};return console.log(this._token),this._token=m,console.log("Token Details:",m),m},getCleaned:function(){return console.log(this._token),this._token??null},initProviderSearch:function(){window.addEventListener("eip6963:announceProvider",(e=>{const t=e;i.push(t.detail)})),window.dispatchEvent(new Event("eip6963:requestProvider"))},getProvider:function(){if(this._EIP6963)return this._EIP6963.provider;if("undefined"==typeof window||!window.ethereum)throw new Error("CryptoModule.getProvider: No Ethereum provider found.");return window.ethereum},getConnected(){return this._connected??null},flush:function(){this._connected=void 0,this._token=void 0;let e=this._EIP6963?.provider;e||(e=this.getProvider()),e.removeAllListeners("accountsChanged");const t=document.getElementById("connect-button"),n=sypher.getUI().connectText;t&&(t.innerHTML=n)}};!function(e){const t={...f,...h,...p,...y,...m,...g};e.sypher=t,console.log("Sypher Modules Initialized")}(window);
//# sourceMappingURL=sypher.esm.min.js.map
