import{ethers as e}from"ethers";const t={validateChain:async function(e){if(!e)throw new Error("CryptoModule.validateChain: Please provide a chain to validate.");try{console.log("Validating chain...");const t=await fetch("https://raw.githubusercontent.com/Tukyo/sypher-tools/refs/heads/main/config/chains.min.json");if(!t.ok)throw new Error("CryptoModule.validateChain: Failed to fetch chain data.");const n=(await t.json())[e.toLowerCase()];if(!n||!n.id)throw new Error(`CryptoModule.validateChain: Chain "${e}" is not supported. Supported Chains: https://github.com/Tukyo/sypher-tools/blob/main/config/chains.json`);return`0x${n.id.toString(16)}`}catch(e){throw new Error(`CryptoModule.validateChain: ${e instanceof Error?e.message:JSON.stringify(e)}`)}}},n={initLogger:function(){const e=document.querySelector("#log-modal"),t=document.querySelector("#log-mc"),n=document.querySelector("#log-mt"),o=console.log,i=console.error;function r(e){const n=document.createElement("div");n.className="log-item",e.forEach((e=>{Array.isArray(e)?e.forEach((e=>a(e,n))):a(e,n)})),t&&(t.appendChild(n),t.scrollTop=t.scrollHeight)}function a(e,t){const n=document.createElement("div");if(e instanceof Error)t.classList.add("log-error"),n.className="log-object error-object",n.innerHTML=`<pre>${c(s({message:e.message,name:e.name,stack:e.stack},2))}</pre>`;else if(e instanceof HTMLElement)n.className="log-dom",n.innerHTML=`<pre>&lt;${e.tagName.toLowerCase()} id="${e.id}" class="${e.className}"&gt;</pre>`;else if("object"==typeof e&&null!==e){n.className="log-object";try{n.innerHTML=`<pre>${c(s(e,2))}</pre>`}catch(e){n.textContent=`[Unserializable object: ${e.message}]`}}else"string"==typeof e?(n.className=l(e)?"log-address":"log-string",n.textContent=e):"number"==typeof e?(n.className="log-number",n.textContent=e.toString()):(n.className="log-unknown",n.textContent=String(e));t.appendChild(n)}function s(e,t=2){const n=new WeakSet;return JSON.stringify(e,((e,t)=>{if("object"==typeof t&&null!==t){if(n.has(t))return"[Circular]";n.add(t)}return t}),t)}function c(e){return e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(\.\d+)?([eE][+-]?\d+)?)/g,(e=>{let t="log-number";return/^"/.test(e)?t=/:$/.test(e)?"log-key":l(e.replace(/"/g,""))?"log-address":"log-string":/true|false/.test(e)?t="log-boolean":/null/.test(e)&&(t="log-null"),`<span class="${t}">${e}</span>`}))}function l(e){return/^0x[a-fA-F0-9]{40}$/.test(e)}function d(){e&&t&&n&&(t.classList.contains("lc-hide")?(t.classList.remove("lc-hide"),t.classList.add("lc-show"),n.innerHTML='<i class="fa-solid fa-caret-left"></i>',e.classList.remove("lm-hide"),e.classList.add("lm-show")):(t.classList.remove("lc-show"),t.classList.add("lc-hide"),n.innerHTML='<i class="fa-solid fa-caret-right"></i>',e.classList.remove("lm-show"),e.classList.add("lm-hide")))}console.log=function(...e){o.apply(console,e),r(e)},console.error=function(...e){i.apply(console,e),r(e)},window.onerror=function(e,t,n,o,i){r([`Error: ${e} at ${t}:${n}:${o}`,i])},window.addEventListener("unhandledrejection",(function(e){r(["Unhandled Promise Rejection:",e.reason])})),n&&n.addEventListener("click",d),d()}},o={truncate:function(e,t=6,n=4){if(!e)throw new Error("TruncationModule.truncate: Please provide a string to truncate.");return e.length<=t+n+3?e:`${e.slice(0,t)}...${e.slice(-n)}`},truncateBalance:function(e,t=2,n=8){if(null==e)throw new Error("TruncationModule.truncateBalance: Please provide a number to truncate.");const o=parseFloat(e.toString());if(o>=1e15)return`${(o/1e15).toFixed(t)}Q`;if(o>=1e12)return`${(o/1e12).toFixed(t)}T`;if(o>=1e9)return`${(o/1e9).toFixed(t)}B`;if(o>=1e6)return`${(o/1e6).toFixed(t)}M`;if(o>=1e3)return`${(o/1e3).toFixed(t)}K`;const[i,r=""]=o.toString().split(".");if(i.length>=n)return i;const a=n-i.length-1,s=r.slice(0,Math.max(a,0));return s?`${i}.${s}`:i}},i={pageFocus:function(){const e="visible"===document.visibilityState;return e?console.log("Page Focused..."):console.log("Page Unfocused..."),e},userEnvironment:function(){const e=navigator.userAgent||navigator.vendor,t=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|Windows Phone|webOS/i.test(e),n=/iPad|Tablet/i.test(e),o=!t&&!n,i={width:window.screen.width,height:window.screen.height,availableWidth:window.screen.availWidth,availableHeight:window.screen.availHeight,colorDepth:window.screen.colorDepth,pixelDepth:window.screen.pixelDepth};return{isMobile:t,isTablet:n,isDesktop:o,deviceType:t?n?"Tablet":"Mobile":"Desktop",browser:(()=>{const t=e.toLowerCase();return/chrome|crios|crmo/i.test(t)&&!/edge|opr\//i.test(t)?"Chrome":/firefox|fxios/i.test(t)?"Firefox":/safari/i.test(t)&&!/chrome|crios|crmo|opr\//i.test(t)?"Safari":/opr\//i.test(t)?"Opera":/edg/i.test(t)?"Edge":/msie|trident/i.test(t)?"Internet Explorer":"Unknown"})(),operatingSystem:/windows phone/i.test(e)?"Windows Phone":/win/i.test(e)?"Windows":/android/i.test(e)?"Android":/mac/i.test(e)?"MacOS":/iphone|ipad|ipod/i.test(e)?"iOS":/linux/i.test(e)?"Linux":"Unknown",userAgent:e,ethereum:"ethereum"in window&&void 0!==window.ethereum,platform:navigator.platform,languages:navigator.languages||[navigator.language],cookiesEnabled:navigator.cookieEnabled,screenDetails:i,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}}},r=["none","custom","default","light"],a=["none","custom","connect","provider"],s=["none","custom","log","connect"],c=/^0x[a-fA-F0-9]{40}$/,l=[],d=[{info:{icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTI4IDU2YzE1LjQ2NCAwIDI4LTEyLjUzNiAyOC0yOFM0My40NjQgMCAyOCAwIDAgMTIuNTM2IDAgMjhzMTIuNTM2IDI4IDI4IDI4WiIgZmlsbD0iIzFCNTNFNCIvPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNNyAyOGMwIDExLjU5OCA5LjQwMiAyMSAyMSAyMXMyMS05LjQwMiAyMS0yMVMzOS41OTggNyAyOCA3IDcgMTYuNDAyIDcgMjhabTE3LjIzNC02Ljc2NmEzIDMgMCAwIDAtMyAzdjcuNTMzYTMgMyAwIDAgMCAzIDNoNy41MzNhMyAzIDAgMCAwIDMtM3YtNy41MzNhMyAzIDAgMCAwLTMtM2gtNy41MzNaIiBmaWxsPSIjZmZmIi8+PC9zdmc+",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",uuid:"96b79a0d-c5cd-48de-924b-af5c7bb68b7e",onboard:{bool:!0,link:"https://www.coinbase.com/wallet",deeplink:"cbwallet://",fallback:{ios:"https://apps.apple.com/us/app/coinbase-wallet-nfts-crypto/id1278383455",android:"https://play.google.com/store/apps/details?id=org.toshi"}}},provider:{}},{info:{icon:"data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjMzIiB2aWV3Qm94PSIwIDAgMzUgMzMiIHdpZHRoPSIzNSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjI1Ij48cGF0aCBkPSJtMzIuOTU4MiAxLTEzLjEzNDEgOS43MTgzIDIuNDQyNC01LjcyNzMxeiIgZmlsbD0iI2UxNzcyNiIgc3Ryb2tlPSIjZTE3NzI2Ii8+PGcgZmlsbD0iI2UyNzYyNSIgc3Ryb2tlPSIjZTI3NjI1Ij48cGF0aCBkPSJtMi42NjI5NiAxIDEzLjAxNzE0IDkuODA5LTIuMzI1NC01LjgxODAyeiIvPjxwYXRoIGQ9Im0yOC4yMjk1IDIzLjUzMzUtMy40OTQ3IDUuMzM4NiA3LjQ4MjkgMi4wNjAzIDIuMTQzNi03LjI4MjN6Ii8+PHBhdGggZD0ibTEuMjcyODEgMjMuNjUwMSAyLjEzMDU1IDcuMjgyMyA3LjQ2OTk0LTIuMDYwMy0zLjQ4MTY2LTUuMzM4NnoiLz48cGF0aCBkPSJtMTAuNDcwNiAxNC41MTQ5LTIuMDc4NiAzLjEzNTggNy40MDUuMzM2OS0uMjQ2OS03Ljk2OXoiLz48cGF0aCBkPSJtMjUuMTUwNSAxNC41MTQ5LTUuMTU3NS00LjU4NzA0LS4xNjg4IDguMDU5NzQgNy40MDQ5LS4zMzY5eiIvPjxwYXRoIGQ9Im0xMC44NzMzIDI4Ljg3MjEgNC40ODE5LTIuMTYzOS0zLjg1ODMtMy4wMDYyeiIvPjxwYXRoIGQ9Im0yMC4yNjU5IDI2LjcwODIgNC40Njg5IDIuMTYzOS0uNjEwNS01LjE3MDF6Ii8+PC9nPjxwYXRoIGQ9Im0yNC43MzQ4IDI4Ljg3MjEtNC40NjktMi4xNjM5LjM2MzggMi45MDI1LS4wMzkgMS4yMzF6IiBmaWxsPSIjZDViZmIyIiBzdHJva2U9IiNkNWJmYjIiLz48cGF0aCBkPSJtMTAuODczMiAyOC44NzIxIDQuMTU3MiAxLjk2OTYtLjAyNi0xLjIzMS4zNTA4LTIuOTAyNXoiIGZpbGw9IiNkNWJmYjIiIHN0cm9rZT0iI2Q1YmZiMiIvPjxwYXRoIGQ9Im0xNS4xMDg0IDIxLjc4NDItMy43MTU1LTEuMDg4NCAyLjYyNDMtMS4yMDUxeiIgZmlsbD0iIzIzMzQ0NyIgc3Ryb2tlPSIjMjMzNDQ3Ii8+PHBhdGggZD0ibTIwLjUxMjYgMjEuNzg0MiAxLjA5MTMtMi4yOTM1IDIuNjM3MiAxLjIwNTF6IiBmaWxsPSIjMjMzNDQ3IiBzdHJva2U9IiMyMzM0NDciLz48cGF0aCBkPSJtMTAuODczMyAyOC44NzIxLjY0OTUtNS4zMzg2LTQuMTMxMTcuMTE2N3oiIGZpbGw9IiNjYzYyMjgiIHN0cm9rZT0iI2NjNjIyOCIvPjxwYXRoIGQ9Im0yNC4wOTgyIDIzLjUzMzUuNjM2NiA1LjMzODYgMy40OTQ2LTUuMjIxOXoiIGZpbGw9IiNjYzYyMjgiIHN0cm9rZT0iI2NjNjIyOCIvPjxwYXRoIGQ9Im0yNy4yMjkxIDE3LjY1MDctNy40MDUuMzM2OS42ODg1IDMuNzk2NiAxLjA5MTMtMi4yOTM1IDIuNjM3MiAxLjIwNTF6IiBmaWxsPSIjY2M2MjI4IiBzdHJva2U9IiNjYzYyMjgiLz48cGF0aCBkPSJtMTEuMzkyOSAyMC42OTU4IDIuNjI0Mi0xLjIwNTEgMS4wOTEzIDIuMjkzNS42ODg1LTMuNzk2Ni03LjQwNDk1LS4zMzY5eiIgZmlsbD0iI2NjNjIyOCIgc3Ryb2tlPSIjY2M2MjI4Ii8+PHBhdGggZD0ibTguMzkyIDE3LjY1MDcgMy4xMDQ5IDYuMDUxMy0uMTAzOS0zLjAwNjJ6IiBmaWxsPSIjZTI3NTI1IiBzdHJva2U9IiNlMjc1MjUiLz48cGF0aCBkPSJtMjQuMjQxMiAyMC42OTU4LS4xMTY5IDMuMDA2MiAzLjEwNDktNi4wNTEzeiIgZmlsbD0iI2UyNzUyNSIgc3Ryb2tlPSIjZTI3NTI1Ii8+PHBhdGggZD0ibTE1Ljc5NyAxNy45ODc2LS42ODg2IDMuNzk2Ny44NzA0IDQuNDgzMy4xOTQ5LTUuOTA4N3oiIGZpbGw9IiNlMjc1MjUiIHN0cm9rZT0iI2UyNzUyNSIvPjxwYXRoIGQ9Im0xOS44MjQyIDE3Ljk4NzYtLjM2MzggMi4zNTg0LjE4MTkgNS45MjE2Ljg3MDQtNC40ODMzeiIgZmlsbD0iI2UyNzUyNSIgc3Ryb2tlPSIjZTI3NTI1Ii8+PHBhdGggZD0ibTIwLjUxMjcgMjEuNzg0Mi0uODcwNCA0LjQ4MzQuNjIzNi40NDA2IDMuODU4NC0zLjAwNjIuMTE2OS0zLjAwNjJ6IiBmaWxsPSIjZjU4NDFmIiBzdHJva2U9IiNmNTg0MWYiLz48cGF0aCBkPSJtMTEuMzkyOSAyMC42OTU4LjEwNCAzLjAwNjIgMy44NTgzIDMuMDA2Mi42MjM2LS40NDA2LS44NzA0LTQuNDgzNHoiIGZpbGw9IiNmNTg0MWYiIHN0cm9rZT0iI2Y1ODQxZiIvPjxwYXRoIGQ9Im0yMC41OTA2IDMwLjg0MTcuMDM5LTEuMjMxLS4zMzc4LS4yODUxaC00Ljk2MjZsLS4zMjQ4LjI4NTEuMDI2IDEuMjMxLTQuMTU3Mi0xLjk2OTYgMS40NTUxIDEuMTkyMSAyLjk0ODkgMi4wMzQ0aDUuMDUzNmwyLjk2Mi0yLjAzNDQgMS40NDItMS4xOTIxeiIgZmlsbD0iI2MwYWM5ZCIgc3Ryb2tlPSIjYzBhYzlkIi8+PHBhdGggZD0ibTIwLjI2NTkgMjYuNzA4Mi0uNjIzNi0uNDQwNmgtMy42NjM1bC0uNjIzNi40NDA2LS4zNTA4IDIuOTAyNS4zMjQ4LS4yODUxaDQuOTYyNmwuMzM3OC4yODUxeiIgZmlsbD0iIzE2MTYxNiIgc3Ryb2tlPSIjMTYxNjE2Ii8+PHBhdGggZD0ibTMzLjUxNjggMTEuMzUzMiAxLjEwNDMtNS4zNjQ0Ny0xLjY2MjktNC45ODg3My0xMi42OTIzIDkuMzk0NCA0Ljg4NDYgNC4xMjA1IDYuODk4MyAyLjAwODUgMS41Mi0xLjc3NTItLjY2MjYtLjQ3OTUgMS4wNTIzLS45NTg4LS44MDU0LS42MjIgMS4wNTIzLS44MDM0eiIgZmlsbD0iIzc2M2UxYSIgc3Ryb2tlPSIjNzYzZTFhIi8+PHBhdGggZD0ibTEgNS45ODg3MyAxLjExNzI0IDUuMzY0NDctLjcxNDUxLjUzMTMgMS4wNjUyNy44MDM0LS44MDU0NS42MjIgMS4wNTIyOC45NTg4LS42NjI1NS40Nzk1IDEuNTE5OTcgMS43NzUyIDYuODk4MzUtMi4wMDg1IDQuODg0Ni00LjEyMDUtMTIuNjkyMzMtOS4zOTQ0eiIgZmlsbD0iIzc2M2UxYSIgc3Ryb2tlPSIjNzYzZTFhIi8+PHBhdGggZD0ibTMyLjA0ODkgMTYuNTIzNC02Ljg5ODMtMi4wMDg1IDIuMDc4NiAzLjEzNTgtMy4xMDQ5IDYuMDUxMyA0LjEwNTItLjA1MTloNi4xMzE4eiIgZmlsbD0iI2Y1ODQxZiIgc3Ryb2tlPSIjZjU4NDFmIi8+PHBhdGggZD0ibTEwLjQ3MDUgMTQuNTE0OS02Ljg5ODI4IDIuMDA4NS0yLjI5OTQ0IDcuMTI2N2g2LjExODgzbDQuMTA1MTkuMDUxOS0zLjEwNDg3LTYuMDUxM3oiIGZpbGw9IiNmNTg0MWYiIHN0cm9rZT0iI2Y1ODQxZiIvPjxwYXRoIGQ9Im0xOS44MjQxIDE3Ljk4NzYuNDQxNy03LjU5MzIgMi4wMDA3LTUuNDAzNGgtOC45MTE5bDIuMDAwNiA1LjQwMzQuNDQxNyA3LjU5MzIuMTY4OSAyLjM4NDIuMDEzIDUuODk1OGgzLjY2MzVsLjAxMy01Ljg5NTh6IiBmaWxsPSIjZjU4NDFmIiBzdHJva2U9IiNmNTg0MWYiLz48L2c+PC9zdmc+",name:"MetaMask",rdns:"io.metamask",uuid:"974b295e-a371-4e37-a428-b82abf69ec3c",onboard:{bool:!0,link:"https://metamask.io/",deeplink:"metamask://",fallback:{ios:"https://apps.apple.com/us/app/metamask-blockchain-wallet/id1438144202",android:"https://play.google.com/store/apps/details?id=io.metamask&pli=1"}}},provider:{}}],u=["function latestRoundData() view returns (uint80 roundId, int256 answer, uint256 startedAt, uint256 updatedAt, uint80 answeredInRound)","function description() view returns (string)"],h=["function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 amount) returns (bool)","function balanceOf(address account) view returns (uint256)","function decimals() view returns (uint8)","function name() view returns (string)","function symbol() view returns (string)","function totalSupply() view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)"],p=["function getReserves() view returns (uint112 _reserve0, uint112 _reserve1, uint32 _blockTimestampLast)","function token0() view returns (address)","function token1() view returns (address)","function totalSupply() view returns (uint256)","function balanceOf(address owner) view returns (uint256)","function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 value) returns (bool)","function transfer(address to, uint256 value) returns (bool)","function transferFrom(address from, address to, uint256 value) returns (bool)"],m=["function slot0() view returns (uint160 sqrtPriceX96, int24 tick, uint16 observationIndex, uint16 observationCardinality, uint16 observationCardinalityNext, uint8 feeProtocol, bool unlocked)","function token0() view returns (address)","function token1() view returns (address)","function fee() view returns (uint24)","function decimals() view returns (uint8)","function liquidity() view returns (uint128)"],g=["https://eth.llamarpc.com","https://rpc.ankr.com/eth","https://ethereum-rpc.publicnode.com","https://1rpc.io/eth","https://rpc.mevblocker.io"],y={initTheme:function(e="default"){if("string"!=typeof e)throw new Error("InterfaceModule.initTheme: Theme must be a string.");if(this._theme)return;"none"===e&&(e="custom");const t=`sypher-${e}-theme`;if(!document.getElementById(t)){const n=document.createElement("link");n.id=t,n.rel="stylesheet",n.href=`/dist/css/themes/sypher-${e}-theme.css`,document.head.appendChild(n),this._theme=e}},applyStyle:function(e,t){if(!e||0===e.length)throw new Error("InterfaceModule.applyStyle: Elements are required.");if(!t||"object"!=typeof t)throw new Error("InterfaceModule.applyStyle: Params object is required.");const n=t.type;let o=t.theme;"none"===o&&(o="custom"),this._theme||this.initTheme(o);const i=`sypher-${n}`;if(!document.getElementById(i)){const e=document.createElement("link");e.id=i,e.rel="stylesheet",e.href=`/dist/css/sypher-${n}.css`,document.head.appendChild(e)}},createButton:function(e){const t={type:"connect",text:"Connect Wallet",icon:"",modal:!1,theme:"none",append:document.body,onClick:()=>sypher.connect("ethereum"),initCrypto:{}},n={...t,...e},{type:o,text:i,icon:s,modal:c,theme:l,append:d,onClick:u,initCrypto:h}=n;if(!a.includes(o))throw new Error(`InterfaceModule.createModal: Type '${o}' not found.`);if(!r.includes(l))throw new Error(`InterfaceModule.createModal: Theme '${l}' not found.`);let p=this._theme||l;"none"===l&&(p="custom");let m=o;"none"===o&&(m="custom");const g={type:o,theme:p};if(!g)return null;if("connect"===m){if("none"===h.chain)throw new Error("InterfaceModule.createButton: Chain is required for type 'connect'.");const e=`${m}-button`,n=`${p}-button`,o=`${m}-button`;let r=document.getElementById(o);r||(r=document.createElement("button"),r.id=o,d.appendChild(r)),r.classList.add(e,n),r.textContent=i,this._connectText=i;const a=u===t.onClick?()=>sypher.connect("none"!==h.chain?h.chain:"ethereum"):u;return c?(console.log("Modal Enabled..."),r.onclick=()=>this.createModal({append:document.body,type:"connect",theme:p,initCrypto:h}),sypher.initProviderSearch()):r.onclick=a,this.applyStyle([r],g),r}if("provider"===m){if("none"===h.chain)throw new Error("InterfaceModule.createButton: Chain is required for type 'provider'.");const e=document.createElement("div");e.id=i.toLowerCase().replace(/\s+/g,"-"),e.classList.add("connect-mi"),e.addEventListener("click",u);const t=document.createElement("img");t.classList.add("connect-mim"),t.src=s;const n=document.createElement("span");return n.classList.add("connect-min"),n.innerText=i,this.applyStyle([e,t,n],g),d.appendChild(e),e.appendChild(t),e.appendChild(n),e}return null},createModal:async function(e){const t={...{append:document.body,type:"none",theme:"none",initCrypto:{}},...e},{append:n,type:o,theme:i,initCrypto:a}=t;if(!s.includes(o))throw new Error(`InterfaceModule.createModal: Type '${o}' not found.`);if(!r.includes(i))throw new Error(`InterfaceModule.createModal: Theme '${i}' not found.`);let c=this._theme||i;if("none"===i&&(c="custom"),"none"===o)return null;const u=this.initModal(o,c);if(!u)return null;if("log"===u.type)return this.applyStyle([u.parent,u.container,u.toggle],t),n.appendChild(u.parent),u.parent.appendChild(u.container),u.parent.appendChild(u.toggle),sypher.initLogger(),u;if("connect"===u.type){this.applyStyle([u.parent,u.container,u.toggle,u.head,u.title,u.body],t),u.parent.addEventListener("click",(e=>{e.target===u.parent&&u.parent.remove()})),n.appendChild(u.parent),u.parent.appendChild(u.container),u.container.appendChild(u.head),u.head.appendChild(u.title),u.head.appendChild(u.toggle),u.container.appendChild(u.body);const e=[...d.map((e=>{const t=l.find((t=>t.info.name===e.info.name)),n=t||e;return t&&(n.info.onboard||(n.info.onboard={bool:!1,link:"",deeplink:"",fallback:{ios:"",android:""}}),n.info.onboard.bool=!1),n})),...l.filter((e=>!d.some((t=>t.info.name===e.info.name))))],o=sypher.getConnected();if(e.forEach((e=>{const{name:t,icon:n}=e.info,i=e.info.onboard?.bool?()=>{sypher.onboard(e)}:()=>{"none"!==a.chain?sypher.initCrypto({chain:a.chain,contractAddress:a.contractAddress,poolAddress:a.poolAddress,pairAddress:a.pairAddress,version:a.version,detail:e,icon:a.icon}):sypher.connect(a.chain,e)},r=this.createButton({append:u.body,type:"provider",text:t,icon:n,modal:!1,theme:c,onClick:i,initCrypto:a});null!==r&&null!=o&&(r.style.display="none")})),null!=o){u.title.innerHTML="Account";const t=sypher.getCleaned();let n,i=!1,r="av-b-c-hide",a="",s="",c=0,l=0,d="",h=0;t&&(i=!0,r="av-b-c",n=t.user.ens||void 0,a=t.token.icon||"",s=t.token.name||"",c=t.user.ethBalance||0,l=t.user.tokenBalance||0,d=t.user.value||"",h=t.token.tokenPrice||0,t.token.decimals);const p=this.createElement({append:u.body,type:"div",id:"account-view",children:[{type:"div",classes:["av-h"],children:[{type:"h2",classes:["av-h-ti"],innerHTML:n?`${sypher.truncate(n)}`:`${sypher.truncate(o)}`},{type:"h3",classes:["av-h-ba"],innerHTML:`${sypher.truncateBalance(parseFloat(c.toString()))} ETH`}]},{type:"div",classes:["av-b"],children:[{type:"div",id:"av-b-td",classes:[r],children:[{type:"div",classes:["av-b-td-ic"],children:[{type:"img",classes:["av-b-td-i"],attributes:{src:a}},{type:"div",classes:["av-b-td-n"],innerHTML:i?`$${sypher.truncateBalance(parseFloat(h.toString()))}`:""}]},{type:"div",classes:["av-b-td-bal"],innerHTML:i?`${sypher.truncateBalance(parseFloat(l.toString()))} ${s}`:""},{type:"div",classes:["av-b-td-val"],innerHTML:i?`$${sypher.truncateBalance(parseFloat(d.toString()))}`:""}]},{type:"div",id:"av-b-provider",classes:["av-b-b"],events:{click:()=>{p&&(p.style.display="none");const e=document.querySelectorAll(".connect-mi");e&&e.forEach((e=>{e.style.display="flex"})),u.title.innerHTML="Change Wallet"}},children:[{type:"div",classes:["av-b-bn-ic"],children:[{type:"img",classes:["av-b-bn-i"],attributes:{src:e[0].info.icon}},{type:"img",classes:["av-b-bn-i"],attributes:{src:e[1].info.icon}}]},{type:"div",classes:["av-b-bn-t"],innerHTML:"Change Wallet"}]}]},{type:"div",classes:["av-x"],events:{click:()=>{sypher.disconnect(),p&&p.parentNode&&p.parentNode.removeChild(p);const e=document.querySelectorAll(".connect-mi");e&&e.forEach((e=>{e.style.display="flex"}));const t=document.getElementById("connect-button");t&&this._connectText&&(t.innerHTML=this._connectText),u.title.innerHTML="Connect Wallet"}},innerHTML:"Disconnect"}]});if(!p)return null}return u}return null},initModal:function(e,t="custom"){if(!e||"string"!=typeof e)throw new Error("InterfaceModule.initModal: Type is required.");if(!s.includes(e))throw new Error(`InterfaceModule.initModal: Type '${e}' not found.`);if("none"===e||"custom"===e)return null;if("log"===e){const n=document.createElement("div");n.id=`${e}-modal`,n.classList.add(`${t}-modal`);const o=document.createElement("div");o.id=`${e}-mc`,o.classList.add(`${t}-mc`);const i=document.createElement("div");i.id=`${e}-mt`,i.classList.add(`${t}-mt`);return{type:e,parent:n,container:o,toggle:i}}if("connect"===e){const n=document.createElement("div");n.id=`${e}-modal`,n.classList.add(`${t}-modal`);const o=document.createElement("div");o.id=`${e}-mc`,o.classList.add(`${t}-mc`);const i=document.createElement("div");i.id=`${e}-mh`,i.classList.add(`${t}-mh`);const r=document.createElement("img");r.id=`${e}-mx`,r.classList.add(`${t}-mx`),r.src="https://raw.githubusercontent.com/leungwensen/svg-icon/8b84d725b0d2be8f5d87cac7f2c386682ce43563/dist/svg/zero/close-c.svg",r.addEventListener("click",(()=>{n.remove()}));const a=document.createElement("h2");a.id=`${e}-mt`,a.classList.add(`${t}-mt`),a.innerText="Connect Wallet";const s=document.createElement("div");s.id=`${e}-mb`,s.classList.add(`${t}-mb`);return{type:e,parent:n,container:o,toggle:r,head:i,title:a,body:s}}return null},createElement:function(e){const t={...{append:document.body,type:"div",id:"",classes:[],attributes:{},events:{},innerHTML:"",children:[]},...e},{append:n,type:o,id:i,theme:a,classes:s,attributes:c,events:l,innerHTML:d,children:u}=t;if(a&&!r.includes(a))throw new Error(`InterfaceModule.createElement: Theme '${a}' not found.`);let h=this._theme||a;"none"===a&&(h="custom");const p=document.createElement(o);if(i&&""!==i&&(p.id=i),p.classList.add(`sypher-${h}-element`),s&&s.forEach((e=>{p.classList.add(e)})),c)for(const[e,t]of Object.entries(c))p.setAttribute(e,t);if(l)for(const[e,t]of Object.entries(l))p.addEventListener(e,t);return d&&""!==d&&(p.innerHTML=d),u&&u.forEach((e=>{const t=this.createElement(e);t&&p.appendChild(t)})),n&&n.appendChild(p),p},toggleLoader:function(e){const t={...{element:document.body,isEnabled:!0,newText:"",loaderHTML:'<div class="loader"></div>',replace:!0},...e},{element:n,isEnabled:o,newText:i,loaderHTML:r,replace:a}=t;if(o){if(a)n.innerHTML=r;else if(!n.querySelector(".loader")){const e=document.createElement("div");e.classList.add("loader"),n.appendChild(e)}}else{if("sypher.revert"===i){const e=n.querySelector(".loader");return void(e&&e.remove())}n.innerHTML=i}},parallax:function(){const e=document.querySelectorAll("[data-speed]");function t(){e.forEach((e=>{const t=parseFloat(e.dataset.speed||"0.5"),n=window.scrollY*t;e.style.transform=`translateY(${-n}px)`}))}0!==e.length?(console.log("Parallax enabled on ",e.length," elements."),window.addEventListener("scroll",(function(){requestAnimationFrame(t)})),t()):console.warn("InterfaceModule.parallax: Parallax enabled, but no elements found with the [data-speed] attribute.")},fade:function(e="20px",t="0.5s"){if("string"!=typeof e||"string"!=typeof t)throw new Error("InterfaceModule.fade: Params must be strings.");const n=document.querySelectorAll("[data-fade]");if(0===n.length)return void console.warn("InterfaceModule.fade: Fade enabled, but no elements found with the [data-fade] attribute.");console.log("Fade enabled on ",n.length," elements."),n.forEach((n=>{n.style.opacity="0",n.style.transform=`translateY(${e})`,n.style.transition=`opacity ${t} ease-out, transform ${t} ease-out`}));const o=new IntersectionObserver((t=>{t.forEach((t=>{const n=t.target;t.isIntersecting&&t.intersectionRatio>.1?(n.style.opacity="1",n.style.transform="translateY(0)"):(n.style.opacity="0",n.style.transform=`translateY(${e})`)}))}),{threshold:.1});n.forEach((e=>o.observe(e)))},getUI:function(){return{theme:this._theme||"",connectText:this._connectText||""}}},w={initCrypto:async function(e){if(!e)return null;e.pair||(e.pair="ethereum"),this.flush();try{if(!(this._chain?.chainId??await sypher.validateChain(e.chain)))return null;const t=await this.connect(e.chain,e.detail);if(!t)return null;const n=t.primaryAccount;if(!n)return null;const o=t.ethBalance;if(null==o)return null;console.log("Getting details for:",e);const i=await this.getTokenDetails(e.chain,e.contractAddress);if(!i)return null;const{balance:r,decimals:a,name:s,symbol:c,totalSupply:l}=i;let d;if("V2"===e.version){const t=await this.getPriceV2(e.chain,e.poolAddress,e.pair,e.pairAddress);if(!t)return null;d=t}else{if("V3"!==e.version)return null;{const t=await this.getPriceV3(e.chain,e.contractAddress,e.poolAddress,e.pair,e.pairAddress);if(!t)return null;d=t}}const u=this.getUserValue(r,d);if(null==u)return null;const h=e.contractAddress,p=e.poolAddress,m=e.pairAddress,g=e.icon??"",y=e.version,w=e.pair,M={address:n,ens:await this.getENS(n)??void 0,contractAddress:h,poolAddress:p,pairAddress:m,balance:r,ethBalance:o,decimals:a,name:s,symbol:c,icon:g,totalSupply:l,tokenPrice:d,userValue:u,version:y,pair:w};if(!M)return null;const f=this.clean(M);if(!f)return null;const I=f;return window.dispatchEvent(new CustomEvent("sypher:initCrypto",{detail:I})),I}catch(e){throw new Error(`CryptoModule.initCrypto: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},connect:async function(e,t=null){if(!e)throw new Error("CryptoModule.connect: Chain is required");console.log("Chain:",e,"Detail:",t);const n=document.getElementById("connect-button")||null,o=t||this._EIP6963;if(this._connected&&!o)return{primaryAccount:this._connected,ethBalance:this._ethBalance};if(o){const t=document.querySelectorAll(".connect-mi"),i=document.getElementById("connect-mb"),r=document.getElementById("connect-mc"),a=document.getElementById("connect-modal");if(t.length>0&&t.forEach((e=>{e.style.display="none"})),i){const e={element:i,loaderHTML:"<div class='loader'></div>",isEnabled:!0,replace:!1};sypher.toggleLoader(e)}this._EIP6963=o;try{const t=o.provider;console.log("[EIP-6963] Using provider:",o.info.name);const s=await t.request({method:"eth_requestAccounts"});if(!Array.isArray(s)||!s.length)throw new Error("No accounts returned by the chosen provider.");const c=s[0];console.log("[EIP-6963] Connection Success!"),await this.switchChain(e),this._connected=c,i&&(i.innerHTML=`\n                        <div class="connect-sb">\n                            <p class="connect-s">Connected to ${o.info.name}</p>\n                            <p class="connect-s">Account: <span class="sypher-a">${sypher.truncate(c)}</span></p>\n                        </div>\n                    `,i.classList.add("min-height-a")),r&&r.classList.add("height-a"),a&&(setTimeout((()=>{a.style.opacity="0%"}),5e3),setTimeout((()=>{a.remove()}),6e3)),null!==n&&(n.innerHTML=`${sypher.truncate(c)}`),window.dispatchEvent(new CustomEvent("sypher:connect",{detail:c})),this.accountChange(!0);const l=await this.getETH();this._ethBalance=l;const d=await this.getENS(c);return this._ens=d,null!=d&&n&&(n.innerHTML=`${sypher.truncate(d)}`),{primaryAccount:c,ethBalance:l}}catch(e){const n=e instanceof Error?`${e.message}\n${e.stack}`:JSON.stringify(e,Object.getOwnPropertyNames(e));if(4001===e.code){if(console.log("User denied wallet access..."),window.dispatchEvent(new CustomEvent("sypher:connectFail",{detail:"User denied wallet access"})),i){const e={element:i,isEnabled:!1,newText:"sypher.revert"};sypher.toggleLoader(e)}return t.forEach((e=>{e.style.display="flex"})),null}throw new Error(`CryptoModule.connect: ${n}`)}}else try{const t=this.getProvider();if(!t)return null;const o=await t.request({method:"eth_requestAccounts"});if(!Array.isArray(o)||0===o.length)throw new Error("CryptoModule.connect: No accounts returned by the Ethereum provider.");const i=o[0];if(!i)return console.warn("CryptoModule.connect: Wallet not connected."),null;await this.switchChain(e),this._connected=i,console.log("[WINDOW] Connection Success!"),null!==n&&(n.innerHTML=`${sypher.truncate(i)}`),window.dispatchEvent(new CustomEvent("sypher:connect",{detail:i})),this.accountChange(!0);const r=await this.getETH();this._ethBalance=r;const a=await this.getENS(i);return this._ens=a,null!=a&&n&&(n.innerHTML=`${sypher.truncate(a)}`),{primaryAccount:i,ethBalance:r}}catch(e){const t=e instanceof Error?`${e.message}\n${e.stack}`:JSON.stringify(e,Object.getOwnPropertyNames(e));throw new Error(`CryptoModule.connect: ${t}`)}},disconnect:async function(){this._connected=void 0,this._details=void 0,window.dispatchEvent(new CustomEvent("sypher:disconnect",{detail:this._connected})),this.accountChange(!1)},accountChange:function(e){let t=this._EIP6963?.provider;if(t||(t=this.getProvider()),null!==this._connected&&void 0!==this._connected)if(e)console.log("Listening for account changes..."),t.on("accountsChanged",(e=>{if(!e.length)return void this.disconnect();this._connected=e[0],window.dispatchEvent(new CustomEvent("sypher:accountChange",{detail:this.getConnected()}));const t=document.getElementById("connect-modal");t&&t.remove(),this._chain&&(this._details?this._EIP6963?this.initCrypto({chain:this._chain.shortName.toLowerCase(),contractAddress:this._details.token.contractAddress,poolAddress:this._details.token.poolAddress,pairAddress:this._details.token.pairAddress,version:this._details.token.version,pair:this._details.token.pair,icon:this._details.token.icon,detail:this._EIP6963}):console.log("Unknown Error Occured..."):this.connect(this._chain.chainId,this._EIP6963))}));else{t.removeAllListeners("accountsChanged");const e=document.getElementById("connect-modal");e&&e.remove()}},onboard:async function(e){const t=sypher.userEnvironment(),n=t.isMobile,o="macos"===t.operatingSystem.toLowerCase(),i="android"===t.operatingSystem.toLowerCase();if(n){if(n){const{deeplink:t,fallback:n}=e.info.onboard;if(!o&&!i)return;{const e=o?"ios":"android",i=setTimeout((()=>{if(console.log("Deeplink failed, prompting user for App Store redirection..."),"ios"===e){confirm("Unable to open the app. Please click confirm to download from the app store.")?window.location.href=n[e]:console.log("User canceled App Store redirection.")}else{const t=document.createElement("a");t.href=n[e],t.target="_self",t.rel="noopener",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}),1e3);window.location.href=t,window.addEventListener("blur",(()=>clearTimeout(i)),{once:!0})}}}else window.open(e.info.onboard.link,"_blank")},getETH:async function(){let t=this._EIP6963?.provider;t||(t=this.getProvider());const n=new e.providers.Web3Provider(t).getSigner(),o=await n.getBalance(),i=parseFloat(e.utils.formatEther(o));return console.log("ETH Balance:",i),i},getENS:async function(e){if(!e)throw new Error("CryptoModule.getENS: Address is required");if(this._ens)return this._ens;try{const t=await this.getProvider(!0),n=await t.lookupAddress(e);if(!n)return;return console.log("ENS:",n),this._ens=n,n}catch(e){throw new Error(`CryptoModule.getENS: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getChain:function(){return this._chain},switchChain:async function(e){if(!e)throw new Error("CryptoModule.switchChain: Chain is required");let t=this._EIP6963?.provider;t||(t=this.getProvider());const n=await this.getChainData(e);if(!n)return;const o=n.chainId;if(this._chain?.chainId!==o){n&&(this._chain=n);try{if(await t.request({method:"eth_chainId"})===o)return void(this._chain&&(this._chain.chainId=o));console.log(`Switching to ${e} chain...`),await t.request({method:"wallet_switchEthereumChain",params:[{chainId:o}]}),this._chain&&(this._chain.chainId=o)}catch(i){if(console.warn(`CryptoModule.switchChain: Attempting to add chain: ${e}`),4902!==i.code)throw new Error(`CryptoModule.switchChain: Unable to switch chain "${e}". Details: ${i}`);try{await t.request({method:"wallet_addEthereumChain",params:[n]}),this._chain&&(this._chain.chainId=o)}catch(t){throw new Error(`CryptoModule.switchChain: Unable to add chain "${e}". Details: ${t}`)}}}},getChainData:async function(e){if(!e)throw new Error("CryptoModule.getChainData: Chain is required");try{const t=this._chain?.chainId??await sypher.validateChain(e);if(!t)return null;const n=`https://raw.githubusercontent.com/ethereum-lists/chains/refs/heads/master/_data/chains/eip155-${parseInt(t,16)}.json`,o=await fetch(n);if(!o.ok)throw new Error(`Chain data for ID ${t} not found`);const i=await o.json();let r;if(console.log("Fetched chain data:",i),i.icon)try{const e=`https://raw.githubusercontent.com/ethereum-lists/chains/refs/heads/master/_data/icons/${i.icon}.json`,t=await fetch(e);t.ok?r=await t.json():console.warn(`Icon data for ${i.icon} not found`)}catch(e){console.warn(`Error fetching icon data for ${i.icon}:`,e)}return{name:i.name,chain:i.chain,icon:r,rpc:i.rpc,nativeCurrency:i.nativeCurrency,infoURL:i.infoURL,shortName:i.shortName,chainId:`0x${parseInt(i.chainId,10).toString(16)}`,networkId:i.networkId,ens:i.ens||void 0,explorers:i.explorers||void 0}}catch(e){throw new Error(`CryptoModule.getChainData: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceFeed:async function(t="ethereum"){if(this._pairPrice&&this._pairPrice.value&&this._pairPrice.timestamp&&Date.now()-this._pairPrice.timestamp<6e4)return this._pairPrice.value;"wrappedbitcoin"===t.toLowerCase().replace(/\s+/g,"")&&(t="bitcoin");try{const n=await fetch("https://raw.githubusercontent.com/Tukyo/sypher-tools/refs/heads/main/config/chainlink.min.json");if(!n.ok)throw new Error("CryptoModule.getPriceFeed: Unable to fetch Chainlink data");const o=(await n.json())[t.toLowerCase().replace(/\s+/g,"")];if(!o)throw new Error(`CryptoModule.getPriceFeed: No data found for ${t}. Reference: https://github.com/Tukyo/sypher-tools/blob/main/config/chainlink.json`);const i=Object.keys(o);console.log(`Available quotes for ${t}:`,i);let r=o.usd||o.eth;if(!r)throw new Error(`CryptoModule.getPriceFeed: No USD, ETH, or BTC quote found for ${t}`);console.log("Chosen Quote Details:",r);const{proxy:a,decimals:s}=r,c=await this.getProvider(!0);if(!c)return null;const l=new e.Contract(a,u,c),d=await l.latestRoundData(),h=await l.description(),p=e.utils.formatUnits(d.answer,s);if(console.log(`${h}: ${p}`),o.usd)return this._pairPrice={value:p,timestamp:Date.now()},p;{const n="0x5f4eC3Df9cbd43714FE2740f5E3616155c5b8419",o=new e.Contract(n,u,c),i=await o.latestRoundData(),r=e.utils.formatUnits(i.answer,8),a=parseFloat(p)*parseFloat(r);return console.log(`Final Price for ${t}: $${a}`),this._pairPrice={value:a.toString(),timestamp:Date.now()},a.toString()}}catch(e){throw new Error(`CryptoModule.getPriceFeed: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getTokenDetails:async function(t,n){if(!t)throw new Error("CryptoModule.getTokenDetails: Chain is required");if(!n)throw new Error("CryptoModule.getTokenDetails: Contract address is required");if(!n.match(c))throw new Error("CryptoModule.getTokenDetails: Invalid contract address");try{let o=this._connected;if(null==o){const e=await this.connect(t);if(!e)return null;o=e.primaryAccount}if(!o)return null;let i=this._EIP6963?.provider;i||(i=this.getProvider());const r=new e.providers.Web3Provider(i).getSigner(),a=new e.Contract(n,h,r),s=await a.balanceOf(o),c=await a.decimals(),l=await a.name(),d=await a.symbol(),u=await a.totalSupply();return console.log("Raw Details:",{balance:s,decimals:c,name:l,symbol:d,totalSupply:u}),{balance:s,decimals:c,name:l,symbol:d,totalSupply:u}}catch(e){throw new Error(`CryptoModule.getTokenDetails: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceV2:async function(t,n,o,i){if(!t)throw new Error("CryptoModule.getPriceV2: Chain is required");if(!n)throw new Error("CryptoModule.getPriceV2: Pool address is required");if(!n.match(c))throw new Error("CryptoModule.getPriceV2: Invalid pool address");if(!o)throw new Error("CryptoModule.getPriceV2: Pair is required");if(!i)throw new Error("CryptoModule.getPriceV2: Pair address is required");if(!i.match(c))throw new Error("CryptoModule.getPriceV2: Invalid pair address");try{if(!(this._chain?.chainId??await sypher.validateChain(t)))return null;let r=this._connected;if(null==r){const e=await this.connect(t);if(!e)return null;r=e.primaryAccount}if(!r)return null;const a=await this.getPriceFeed(o);if(!a)return null;let s=this._EIP6963?.provider;s||(s=this.getProvider());const c=new e.providers.Web3Provider(s).getSigner(),l=new e.Contract(n,p,c),d=await l.token0(),u=await l.token1(),m=await l.getReserves(),g=m._reserve0,y=m._reserve1,w=new e.Contract(d,h,c),M=new e.Contract(u,h,c),f=await w.decimals(),I=await M.decimals();console.log("Reserve 0:",g),console.log("Reserve 1:",y),console.log("Token 0:",d),console.log("Token 1:",u),console.log("Decimals 0:",f),console.log("Decimals 1:",I);const N=e.BigNumber.from(g),v=e.BigNumber.from(y),E=parseFloat(e.utils.formatUnits(N,f)),C=parseFloat(e.utils.formatUnits(v,I));let b;if(u.toLowerCase()===i.toLowerCase())b=C/E;else{if(d.toLowerCase()!==i.toLowerCase())throw new Error(`CryptoModule.getPriceV2: Neither token is ${o}`);b=E/C}const j=b*parseFloat(a);return console.log(`V2 Price for token in pool ${n}: $${j}`),j}catch(e){throw new Error(`CryptoModule.getPriceV2: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPriceV3:async function(t,n,o,i,r){if(!t)throw new Error("CryptoModule.getPriceV3: Chain is required");if(!n)throw new Error("CryptoModule.getPriceV3: Contract address is required");if(!n.match(c))throw new Error("CryptoModule.getPriceV3: Invalid contract address");if(!o)throw new Error("CryptoModule.getPriceV3: Pool address is required");if(!o.match(c))throw new Error("CryptoModule.getPriceV3: Invalid pool address");if(!i)throw new Error("CryptoModule.getPriceV3: Pair is required");if(!r)throw new Error("CryptoModule.getPriceV3: Pair address is required");if(!r.match(c))throw new Error("CryptoModule.getPriceV3: Invalid pair address");try{if(!(this._chain?.chainId??await sypher.validateChain(t)))return null;let a=this._connected;if(null==a){const e=await this.connect(t);if(!e)return null;a=e.primaryAccount}if(!a)return null;const s=await this.getPoolV3(t,n,o);if(!s)return null;const{sqrtPriceX96:c,token0:l,token1:d,decimals0:u,decimals1:h}=s,p=e.BigNumber.from(c),m=e.BigNumber.from("79228162514264337593543950336"),g=p.mul(p).mul(e.BigNumber.from(10).pow(u)),y=m.mul(m).mul(e.BigNumber.from(10).pow(h)),w=g.div(y),M=g.mod(y),f=8,I=e.BigNumber.from(10).pow(f),N=M.mul(I).div(y),v=parseFloat(w.toString())+parseFloat(N.toString())/Math.pow(10,f);let E;if(d.toLowerCase()===r.toLowerCase())E=v;else{if(l.toLowerCase()!==r.toLowerCase())throw new Error(`CryptoModule.getPriceV3: Neither token is ${i}`);E=1/v}const C=await this.getPriceFeed(i);if(!C)return null;const b=E*parseFloat(C);return console.log(`V3 Price for token in pool ${sypher.truncate(o)}: $${b}`),b}catch(e){throw new Error(`CryptoModule.getPriceV3: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getPoolV3:async function(t,n,o){if(!t)throw new Error("CryptoModule.getPoolV3: Chain is required");if(!n)throw new Error("CryptoModule.getPoolV3: Contract address is required");if(!n.match(c))throw new Error("CryptoModule.getPoolV3: Invalid contract address");if(!o)throw new Error("CryptoModule.getPoolV3: Pool address is required");if(!o.match(c))throw new Error("CryptoModule.getPoolV3: Invalid pool address");try{if(!(this._chain?.chainId??await sypher.validateChain(t)))return null;let n=this._connected;if(null==n){const e=await this.connect(t);if(!e)return null;n=e.primaryAccount}if(!n)return null;let i=this._EIP6963?.provider;i||(i=this.getProvider());const r=new e.providers.Web3Provider(i).getSigner(),a=new e.Contract(o,m,r),s=(await a.slot0()).sqrtPriceX96;console.log("Sqrt Price X96:",s);const c=await a.token0(),l=await a.token1();console.log("Token 0:",c),console.log("Token 1:",l);const d=new e.Contract(c,h,r),u=new e.Contract(l,h,r),p=await d.decimals(),g=await u.decimals();console.log("Decimals 0:",p),console.log("Decimals 1:",g);const y=await a.liquidity();console.log("Liquidity:",y);return{sqrtPriceX96:s,token0:c,token1:l,decimals0:p,decimals1:g,liquidity:y}}catch(e){throw new Error(`CryptoModule.getPoolV3: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},getUserValue:function(e,t){if(!e)throw new Error("CryptoModule.getUserValue: Balance is required");if(!t)throw new Error("CryptoModule.getUserValue: Price is required");if("object"!=typeof e)throw new Error("CryptoModule.getUserValue: Invalid balance");if("number"!=typeof t)throw new Error("CryptoModule.getUserValue: Invalid price");try{const n=parseFloat(e.toString())*parseFloat(t.toString());return console.log(`User Value: ${n}`),n}catch(e){throw new Error(`CryptoModule.getUserValue: ${e instanceof Error?e.message:JSON.stringify(e)}`)}},clean:function(t){if(!t)throw new Error("CryptoModule.clean: Token details are required");const{address:n,ens:o,contractAddress:i,poolAddress:r,pairAddress:a,ethBalance:s,balance:c,decimals:l,name:d,symbol:u,icon:h,totalSupply:p,tokenPrice:m,userValue:g,version:y,pair:w}=t,M={user:{address:n,ens:o,ethBalance:s,tokenBalance:parseFloat(e.utils.formatUnits(c,l)),value:(parseFloat(g.toString())/Math.pow(10,l)).toFixed(l).toString()},token:{contractAddress:i,poolAddress:r,pairAddress:a,decimals:l,name:d,symbol:u,icon:h,totalSupply:parseFloat(e.utils.formatUnits(p,l)),tokenPrice:parseFloat(m.toString()),version:y,pair:w}};return this._details=M,console.log("Details:",M),M},getCleaned:function(){return console.log(this._details),this._details??null},initProviderSearch:function(){window.addEventListener("eip6963:announceProvider",(e=>{const t=e;l.push(t.detail)})),window.dispatchEvent(new Event("eip6963:requestProvider"))},getProvider:async function(t=!1){if(!t){if(this._EIP6963)return console.log("[EIP6963]: ",this._EIP6963.provider),this._EIP6963.provider;if("undefined"==typeof window||!window.ethereum)throw new Error("CryptoModule.getProvider: No Ethereum provider found.");return console.log("[WINDOW]:",window.ethereum),window.ethereum}for(const t of g)try{const n=new e.providers.JsonRpcProvider(t);return await n.getBlockNumber(),console.log(`[Public RPC]: ${t}`),n}catch(e){const n=e instanceof Error?e.message:String(e);throw new Error(`CryptoModule.getProvider: ${t} - ${n}`)}},getConnected(){return this._connected??null},flush:function(){if(null===this._connected||void 0===this._connected)return void console.log("Nothing to flush...");this._connected=void 0,this._details=void 0,this._pairPrice=void 0,this._ethBalance=void 0,this._ens=void 0;let e=this._EIP6963?.provider;e||(e=this.getProvider()),e.removeAllListeners("accountsChanged");const t=document.getElementById("connect-button"),n=sypher.getUI().connectText;t&&(t.innerHTML=n)}};!function(e){const r={...w,...t,...n,...y,...o,...i};e.sypher=r,console.log("Sypher Modules Initialized")}(window);
//# sourceMappingURL=sypher.esm.min.js.map
